[{"id":"869d7d0b5c603936","type":"tab","label":"[Html2Csv] GMX.de mailinglist export","disabled":false,"info":"::: aim\n\nTo convert HTML snippets to CSV data. \n\nThis example makes use of GMX.de lack of support of CSV export of mailing lists.\n\n:::\n\n### Why?\n\nGMX.de is an email provider in Germany that has been around for years but does not provide a simply way to export emails from a mailinglist.\n\nThe only way - it seems - is to copy HTML code from input boxes and then convert that to CSV data. \n\nWhy GMX should not provide this export is a mystery especically since it is possible to export address books as CSV.\n\n### Steps to reproduce\n\nThis flow converts the HTML that is to be found at GMX into a CSV of email addresses. \n\nAfter login, go to email tab and then you have to go to *Einstellungen* (Settings) to find the *Verteilerlisten* (Mailing lists).\n\n![img](https://cdn.openmindmap.org/content/1691598405380_Screen_Shot_2023-08-09_at_16.25.38.png)\n\nOnce there, pick the mailing list that is required and click on the wrench symbol to create a new email to the mailinglist - the wrench right next to the delete bin!\n\nOnce there, one finds an input field with all(!) the emails in the mailing list. This box:\n\n![img](https://cdn.openmindmap.org/content/1691598909717_Screen_Shot_2023-08-09_at_15.59.02.png)\n\nNow comes the tricky bit because we need the HTML code behind that box. To get that, we need to right-click in the box and select \"Inspect Element\" (or whatever it's called in your favourite browser and language!).\n\n![img](https://cdn.openmindmap.org/content/1691599068481_Screen_Shot_2023-08-09_at_15.55.01.png)\n\nNow it gets *really* messy since in the window that then opens, we need the \"ul\" element which represents the contents of that box:\n\n![img](https://cdn.openmindmap.org/content/1691599156844_Screen_Shot_2023-08-09_at_15.50.12.png)\n\nTo obtain the HTML, we need to copy the \"Outer HTML\" (i.e. including the element itself). Once copied, the contents can be pasted into the <a class=\"ahl-node-only\" data-ids=\"7862f6a413748a2b\">template node</a> of the flow.\n\nPhew! The great thing is that one does this once per lifetime, so it's completely forgotten once done!\n\nTriggering the <a class=\"ahl-node-only\" data-ids=\"3a37909ece26b620\">inject node</a> will create the CSV file with the emails - that's the <a class=\"\" data-ids=\"674e42c2a8661e3a\">write file node</a> at the end of the flow.\n\n### Other approaches\n\nSure there are other approaches to parsing HTML, what I like about this approach is that I move between browser tabs, having GMX open on one and Node-RED on the other - everything happens in the browser.\n\n\n","env":[]},{"id":"f115e22c8cdedf7d","type":"group","z":"869d7d0b5c603936","name":"extract list items from HTML","style":{"label":true},"nodes":["7862f6a413748a2b","c1947e960fd08136"],"x":359,"y":338,"w":273,"h":194},{"id":"17074fe62fd45afc","type":"group","z":"869d7d0b5c603936","name":"extract email address from list element","style":{"label":true},"nodes":["96e9b718067b56b1","ff0791f61d453ab3","48aa503fcdb07de9"],"x":678,"y":450,"w":674,"h":82},{"id":"096a99945f849f35","type":"group","z":"869d7d0b5c603936","name":"generate output","style":{"label":true},"nodes":["4aa04397e4d31731","de47e8dcf57b8b78","674e42c2a8661e3a"],"x":1397,"y":450.5,"w":449,"h":178},{"id":"7862f6a413748a2b","type":"template","z":"869d7d0b5c603936","g":"f115e22c8cdedf7d","name":"REPLACE HTML HERE","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<ul class=\"select2-choices\">\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"one@example.com\">one@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"two@example.com\">two@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"three@example.com\">three@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"four@example.com\">four@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"five@example.com\">five@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"six@example.com\">six@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"seven@example.com\">seven@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"eight@example.com\">eight@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"nine@example.com\">nine@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"ten@example.com\">ten@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"eleven@example.com\">eleven@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n    <li class=\"select2-search-choice\"><a id=\"id161\"\n            class=\"objectivation-address objectivation-address-write objectivation js-component unselectable\"\n            data-webdriver=\"addressWrite\" data-component=\"ObjectivationAddressButtonWrite\" unselectable=\"on\">\n\n            <span class=\"objectivation_name\" title=\"twelve@example.com\">twelve@example.com</span>\n\n            <span class=\"objectivation-address-write_encryption js-action\">\n<i class=\"m-icon objectivation-address-write_encryption-icon\"></i>\n</span>\n            <span class=\"objectivation-address-write_secure js-action\">\n<i class=\"m-icon objectivation-address-write_security\"></i>\n</span>\n\n            <span class=\"objectivation_action js-action\">\n<i class=\"m-icon objectivation_icon-delete\" id=\"id162\"></i>\n</span>\n        </a></li>\n<li class=\"select2-search-field\"> <input type=\"text\" autocomplete=\"off\" style=\"width: 498px;\" class=\"select2-input\">\n</li>\n</ul>","output":"str","x":496,"y":379,"wires":[["c1947e960fd08136"]]},{"id":"3a37909ece26b620","type":"inject","z":"869d7d0b5c603936","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":276,"y":285,"wires":[["7862f6a413748a2b"]]},{"id":"4aa04397e4d31731","type":"debug","z":"869d7d0b5c603936","g":"096a99945f849f35","name":"debug 41","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1740,"y":491.5,"wires":[]},{"id":"96e9b718067b56b1","type":"split","z":"869d7d0b5c603936","g":"17074fe62fd45afc","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":754,"y":491,"wires":[["ff0791f61d453ab3"]]},{"id":"ff0791f61d453ab3","type":"change","z":"869d7d0b5c603936","g":"17074fe62fd45afc","name":"Email becomes `payload.title`","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\t    \"Email\": payload.title\t}","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1026,"y":491,"wires":[["48aa503fcdb07de9"]]},{"id":"de47e8dcf57b8b78","type":"csv","z":"869d7d0b5c603936","g":"096a99945f849f35","name":"","sep":",","hdrin":true,"hdrout":"all","multi":"one","ret":"\\n","temp":"","skip":"0","strings":true,"include_empty_strings":"","include_null_values":"","x":1481,"y":491.5,"wires":[["674e42c2a8661e3a","4aa04397e4d31731"]]},{"id":"48aa503fcdb07de9","type":"join","z":"869d7d0b5c603936","g":"17074fe62fd45afc","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1276,"y":491,"wires":[["de47e8dcf57b8b78"]]},{"id":"674e42c2a8661e3a","type":"file","z":"869d7d0b5c603936","g":"096a99945f849f35","name":"","filename":"/data/emails.csv","filenameType":"str","appendNewline":true,"createDir":false,"overwriteFile":"true","encoding":"none","x":1503,"y":587.5,"wires":[[]]},{"id":"c1947e960fd08136","type":"html","z":"869d7d0b5c603936","g":"f115e22c8cdedf7d","name":"","property":"payload","outproperty":"payload","tag":"ul li a span[title!='']","ret":"attr","as":"single","x":475,"y":491,"wires":[["96e9b718067b56b1"]]}]