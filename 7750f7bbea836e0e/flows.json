[{"id":"7750f7bbea836e0e","type":"tab","label":"[NodeDev] Flow compare trigger update on tab change","disabled":false,"info":"### Description\n\nThis frontend flow triggers the [FlowCompare](https://www.npmjs.com/package/@gregoriusrippenstein/node-red-contrib-flowcompare) node when the flow tab is changed.\n\nThe intention is to have the flow compare sidebar open and when the flow tab is changed, the comparison is updated with the new flow.","env":[]},{"id":"2e790ffcbcda4a42","type":"group","z":"7750f7bbea836e0e","name":"trigger flow compare on tab change","style":{"label":true},"nodes":["dd9a6905261e70fe","9efed3db75d18759","528359d7e0e259e3","8ebbc7c2432974ae","722cb9efd5311dc7"],"x":468,"y":386,"w":1028,"h":214},{"id":"dd9a6905261e70fe","type":"ClientCode","z":"7750f7bbea836e0e","g":"2e790ffcbcda4a42","name":"[Events] On workspace change","clientcode":"\n// *** This code gets excuted in the browser - no backend involved ***\n\n// Ensure that the event listener is only \n// set once.\n\nvar lstnName = \"workspaceListener\" + nodeid;\n\nif (payload == \"setup\") {\n    if (!window[lstnName]) {\n        window[lstnName] = (e) => {\n            node.send({\n                payload: e,\n                data: \"workspace changed\"\n            })\n        }\n        RED.events.on('workspace:change', window[lstnName]);\n\n        RED.notify(\"Workspace listener setup\", {\n            type: \"success\",\n            timeout: 2500,\n            id: nodeid\n        })\n    } else {\n        RED.notify(\"Workspace listener already set up\", {\n            type: \"warning\",\n            timeout: 2500,\n            id: nodeid\n        })\n    }\n}\n\n// Remove listener if required\n\nif (payload == \"remove\") {\n    if (window[lstnName]) {\n        RED.events.off('workspace:change', window[lstnName]);\n        window[lstnName] = undefined;\n        \n        RED.notify(\"Workspace listener removed\", {\n            type: \"success\",\n            timeout: 2500,\n            id: nodeid\n        })        \n    } else {\n        RED.notify(\"No Workspace listener defined\", {\n            type: \"warning\",\n            timeout: 2500,\n            id: nodeid\n        })        \n    }\n}","format":"javascript","x":893,"y":495,"wires":[["528359d7e0e259e3","8ebbc7c2432974ae"]]},{"id":"9efed3db75d18759","type":"inject","z":"7750f7bbea836e0e","g":"2e790ffcbcda4a42","name":"setup event listener","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"setup","payloadType":"str","x":624,"y":427,"wires":[["dd9a6905261e70fe"]]},{"id":"528359d7e0e259e3","type":"debug","z":"7750f7bbea836e0e","g":"2e790ffcbcda4a42","name":"debug 47","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":1166,"y":551,"wires":[]},{"id":"8ebbc7c2432974ae","type":"ClientCode","z":"7750f7bbea836e0e","g":"2e790ffcbcda4a42","name":"[Action] trigger flowcompare:compare-flow-to-remote","clientcode":"// console.log( _msg )\n\nif (payload && (payload.old != payload.workspace) ) {\n    RED.actions.invoke(\"flowcompare:compare-flow-to-remote\")\n}\n","format":"javascript","x":1270,"y":442,"wires":[[]]},{"id":"722cb9efd5311dc7","type":"inject","z":"7750f7bbea836e0e","g":"2e790ffcbcda4a42","name":"remove event listener","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"remove","payloadType":"str","x":614,"y":559,"wires":[["dd9a6905261e70fe"]]}]