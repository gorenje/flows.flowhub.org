[{"id":"40ea5f2aea6592ae","type":"tab","label":"[Web] Router","disabled":false,"info":"### Aim\n\nHandling http requests in a large application can become confusing so most web frameworks have a router concept whereby requests are *routed* to their handlers via their attributes.\n\nRequests are normally routed according to their path, e.g. `/path/path2/file` or their method, i.e., `POST` or `GET` or `PATCH` and so on.\n\nThis flow is one way of doing the same routing but in Node-RED.\n\n### How does it work?\n\nFirst all the <a class=\"ahl-group-only\" data-ids=\"4018e038c15bd294\">http-in nodes</a> are defined that also define all possibles, in this up to a maximum of 4 path elements.\n\nAll paths must begin with `/api` and can only have a maximum of four other paths, i.e., `/api/path1/path2/path3/path4` is the longest route. Also only GET and POST as methods are accepted.\n\n","env":[]},{"id":"487c8f7449f90598","type":"group","z":"40ea5f2aea6592ae","name":"not found","style":{"label":true,"label-position":"sw","color":"#000000"},"nodes":["5f9969817f9c403d","cc0d78a673304144","d80f6bfeaec940de","abc3f4590b0a78c6","cfe518eea648cfe3","c49f0fc343b113fc","a2a7b683c264dd2a"],"x":844.4445104598999,"y":1555.4265775680542,"w":2581.451729774475,"h":90},{"id":"2ba8206c046d35e7","type":"group","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"not found","style":{"label":true,"label-position":"sw","color":"#000000"},"nodes":["575c4dd631dbe29d","9298d66291096b56","54b96e96d686e24a"],"x":1921,"y":869.444580078125,"w":943.5,"h":90},{"id":"2d13d01b3ef30bc0","type":"group","z":"40ea5f2aea6592ae","name":"GET requests","style":{"label":true},"nodes":["650565a2d8f644a7","fba142a7b0634259","d6a91b22db931dbd","ac85faa6b8f463ac","dda684b3e27cb284","b03c04d3dbd79e1a","7ade38efb2383248","b3fcaa365e5bcbe8","0cd28b47ca230b20","4b7ea8384bd26f06","8b28734e016e428f","42c7c23e6ce4e3a4","89b2b92c371d90c8","7763efbb9695e7e8","6e2aa87058c9ca31","2ba8206c046d35e7"],"x":1712.8958320617676,"y":528.0001525878906,"w":1255.6041793823242,"h":457.4444274902344},{"id":"b3ca5ea8fb84a877","type":"group","z":"40ea5f2aea6592ae","name":"POST requests","style":{"label":true},"nodes":["415daddfa2f09e43","341c2535113bf35e","823739615b1244a2","8a9740647d8b9de6","fbb2dcb72c55fd05","bc211ee1f76e75a0","1e760614817dad6e","627985f8a52639b4","68ec96b6342d3dbd","ade7b5712da4f502","0a29338b52b13f31","fb24616382b60b38","46453dd4dcc215e7","5b5c966a1a395882","acbc887acc9963d3","9cccce993a7d460f","b482c43545f18102","0b3e9d820c4adae1","349c67fcf6513cf3","3ee6997d3ccde613","667c3a588eff6983","714f7b2a4a8ba90a","353d91dbcc25531f","762de3a1ad95e96e"],"x":1711.9999923706055,"y":1049.424207687378,"w":1776.8957595825195,"h":386.4649543762207},{"id":"4018e038c15bd294","type":"group","z":"40ea5f2aea6592ae","name":"All http-in nodes","style":{"label":true},"nodes":["42175c8109b17081","168b0844f9b22469","f41d7d3566d08f7e","7ba18c461581ae70","fc4121d2cc388885","f0bc9afd9f2fc65d","7d5b1e56a31f7c94","b0778c06d93a9be6","e651fa2e6bc6cf29","303afc037a9b5e76","8f147e1970be0c60"],"x":506,"y":681.8888549804688,"w":361,"h":616.1113424301147},{"id":"42175c8109b17081","type":"http in","z":"40ea5f2aea6592ae","g":"4018e038c15bd294","name":"","url":"/api/:path1","method":"get","upload":false,"swaggerDoc":"","x":621,"y":1214.0001878738403,"wires":[["48cd9aa96f7d1d8b"]]},{"id":"415daddfa2f09e43","type":"switch","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"POST handler","property":"req.params.path1","propertyType":"msg","rules":[{"t":"eq","v":"proposals","vt":"str"},{"t":"eq","v":"users","vt":"str"},{"t":"eq","v":"proposal","vt":"str"},{"t":"eq","v":"bid","vt":"str"},{"t":"eq","v":"user","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":6,"x":1817.9999923706055,"y":1362.000566482544,"wires":[["c49f0fc343b113fc"],["c49f0fc343b113fc"],["8a9740647d8b9de6"],["fbb2dcb72c55fd05"],["1e760614817dad6e"],["c49f0fc343b113fc"]]},{"id":"a6f30d5708e1a412","type":"http response","z":"40ea5f2aea6592ae","name":"","statusCode":"","headers":{},"x":1990.000244140625,"y":1680.0001220703125,"wires":[]},{"id":"650565a2d8f644a7","type":"link out","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"link out 5","mode":"link","links":["cdfe0a2804636784"],"x":2592.500605583191,"y":712.0002012252808,"wires":[]},{"id":"fba142a7b0634259","type":"link out","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"link out 6","mode":"link","links":["33d7ea129f06d293"],"x":2320.500244140625,"y":569.0001525878906,"wires":[]},{"id":"168b0844f9b22469","type":"http in","z":"40ea5f2aea6592ae","g":"4018e038c15bd294","name":"","url":"/api/:path1/:path2","method":"get","upload":false,"swaggerDoc":"","x":641,"y":1161.0001850128174,"wires":[["48cd9aa96f7d1d8b"]]},{"id":"f41d7d3566d08f7e","type":"http in","z":"40ea5f2aea6592ae","g":"4018e038c15bd294","name":"","url":"/api/:path1/:path2/:path3","method":"get","upload":false,"swaggerDoc":"","x":661,"y":1108.0001239776611,"wires":[["48cd9aa96f7d1d8b"]]},{"id":"d6a91b22db931dbd","type":"switch","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"auctions handler","property":"req.params.path2","propertyType":"msg","rules":[{"t":"eq","v":"all","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2102.89599609375,"y":577.0001525878906,"wires":[["fba142a7b0634259"],["575c4dd631dbe29d"]]},{"id":"ac85faa6b8f463ac","type":"switch","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"proposal handler","property":"req.params.path2","propertyType":"msg","rules":[{"t":"regex","v":"^[a-z0-9-]{36}$","vt":"str","case":true},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2093.89599609375,"y":721.0001516342163,"wires":[["dda684b3e27cb284"],["575c4dd631dbe29d"]]},{"id":"dda684b3e27cb284","type":"function","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"set uuid parameter","func":"msg.req.params[\"uuid\"] = msg.req.params.path2;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2442.5001335144043,"y":712.0000858306885,"wires":[["650565a2d8f644a7"]]},{"id":"5f9969817f9c403d","type":"function","z":"40ea5f2aea6592ae","g":"487c8f7449f90598","name":"not found","func":"msg.statusCode = 404;\nmsg.payload = {\n    status: \"not_found\",\n    msg: \"page not found\",\n    path: msg.req.originalUrl\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1795.500244140625,"y":1596.4265775680542,"wires":[["a6f30d5708e1a412","9c719970bff6c344"]]},{"id":"7ba18c461581ae70","type":"http in","z":"40ea5f2aea6592ae","g":"4018e038c15bd294","name":"","url":"/api","method":"get","upload":false,"swaggerDoc":"","x":601,"y":1257.0001974105835,"wires":[["a2a7b683c264dd2a","48cd9aa96f7d1d8b"]]},{"id":"b03c04d3dbd79e1a","type":"switch","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"users handler","property":"req.params.path2","propertyType":"msg","rules":[{"t":"eq","v":"all","vt":"str"},{"t":"regex","v":"^[a-z0-9-]{36}$","vt":"str","case":true},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":2103.89599609375,"y":653.0001554489136,"wires":[["7ade38efb2383248"],["89b2b92c371d90c8"],["575c4dd631dbe29d"]]},{"id":"7ade38efb2383248","type":"link out","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"link out 7","mode":"link","links":["48669bbc4153ba14"],"x":2321.500244140625,"y":640.0001525878906,"wires":[]},{"id":"341c2535113bf35e","type":"function","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"not implemented","func":"var pa = msg.req.params;\n\nmsg.statusCode = 501;\nmsg.payload = JSON.stringify({\n    status: \"not_implemented\",\n    msg: \"TODO functionality\",\n    path: msg.req.originalUrl\n})\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3191.0001831054688,"y":1145.0002365112305,"wires":[["667c3a588eff6983"]]},{"id":"fc4121d2cc388885","type":"http in","z":"40ea5f2aea6592ae","g":"4018e038c15bd294","name":"","url":"/api/:path1","method":"post","upload":false,"swaggerDoc":"","x":621,"y":883.0000228881836,"wires":[["48cd9aa96f7d1d8b"]]},{"id":"f0bc9afd9f2fc65d","type":"http in","z":"40ea5f2aea6592ae","g":"4018e038c15bd294","name":"","url":"/api/:path1/:path2","method":"post","upload":false,"swaggerDoc":"","x":652,"y":831.0000438690186,"wires":[["48cd9aa96f7d1d8b"]]},{"id":"7d5b1e56a31f7c94","type":"http in","z":"40ea5f2aea6592ae","g":"4018e038c15bd294","name":"","url":"/api/:path1/:path2/:path3","method":"post","upload":false,"swaggerDoc":"","x":671,"y":775.0000438690186,"wires":[["48cd9aa96f7d1d8b"]]},{"id":"b0778c06d93a9be6","type":"http in","z":"40ea5f2aea6592ae","g":"4018e038c15bd294","name":"","url":"/api","method":"post","upload":false,"swaggerDoc":"","x":601,"y":926.0000810623169,"wires":[["a2a7b683c264dd2a","48cd9aa96f7d1d8b"]]},{"id":"45a940ec09abc397","type":"switch","z":"40ea5f2aea6592ae","name":"method","property":"req.method","propertyType":"msg","rules":[{"t":"eq","v":"GET","vt":"str"},{"t":"eq","v":"POST","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":1570.8960189819336,"y":1361.8895378112793,"wires":[["b3fcaa365e5bcbe8"],["415daddfa2f09e43"],["5f9969817f9c403d"]]},{"id":"823739615b1244a2","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"post new offer","mode":"link","links":["25e513171ea468df"],"x":2350.500244140625,"y":1090.424207687378,"wires":[]},{"id":"b3fcaa365e5bcbe8","type":"switch","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"GET handler","property":"req.params.path1","propertyType":"msg","rules":[{"t":"eq","v":"auctions","vt":"str"},{"t":"eq","v":"users","vt":"str"},{"t":"eq","v":"proposal","vt":"str"},{"t":"eq","v":"bid","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":5,"x":1808.8958320617676,"y":765.8890523910522,"wires":[["d6a91b22db931dbd"],["b03c04d3dbd79e1a"],["ac85faa6b8f463ac"],["0cd28b47ca230b20"],["54b96e96d686e24a"]]},{"id":"8a9740647d8b9de6","type":"switch","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"proposal handler","property":"req.params.path2","propertyType":"msg","rules":[{"t":"eq","v":"new","vt":"str"},{"t":"eq","v":"make_decision","vt":"str"},{"t":"regex","v":"^[a-z0-9-]{36}$","vt":"str","case":true},{"t":"else"}],"checkall":"false","repair":false,"outputs":4,"x":2118.895950317383,"y":1142.8891887664795,"wires":[["823739615b1244a2"],["714f7b2a4a8ba90a"],["341c2535113bf35e"],["d80f6bfeaec940de"]]},{"id":"a2a7b683c264dd2a","type":"link out","z":"40ea5f2aea6592ae","g":"487c8f7449f90598","name":"link out 9","mode":"link","links":["cc0d78a673304144"],"x":885.4445104598999,"y":1596.4265775680542,"wires":[]},{"id":"cc0d78a673304144","type":"link in","z":"40ea5f2aea6592ae","g":"487c8f7449f90598","name":"API NOT FOUND","links":["a2a7b683c264dd2a","575c4dd631dbe29d","d80f6bfeaec940de","abc3f4590b0a78c6","cfe518eea648cfe3","16ce1ec17155ded0","9298d66291096b56","c49f0fc343b113fc","54b96e96d686e24a","e7ea8412f6acf2bf"],"x":1469.4376831054688,"y":1596.4265775680542,"wires":[["5f9969817f9c403d"]]},{"id":"575c4dd631dbe29d","type":"link out","z":"40ea5f2aea6592ae","g":"2ba8206c046d35e7","name":"link out 10","mode":"link","links":["cc0d78a673304144"],"x":2281.500244140625,"y":910.444580078125,"wires":[]},{"id":"d80f6bfeaec940de","type":"link out","z":"40ea5f2aea6592ae","g":"487c8f7449f90598","name":"NOT FOUND","mode":"link","links":["cc0d78a673304144"],"x":2295.4453125,"y":1596.4265775680542,"wires":[]},{"id":"9c719970bff6c344","type":"debug","z":"40ea5f2aea6592ae","name":"NOT FOUND","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1988.437744140625,"y":1729.1737060546875,"wires":[]},{"id":"fbb2dcb72c55fd05","type":"switch","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"bid handler","property":"req.params.path2","propertyType":"msg","rules":[{"t":"eq","v":"new","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2138.895950317383,"y":1249.8891220092773,"wires":[["bc211ee1f76e75a0"],["d80f6bfeaec940de"]]},{"id":"bc211ee1f76e75a0","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"post new bid","mode":"link","links":["a1071b9d620c40d4"],"x":2350.500244140625,"y":1243.4239501953125,"wires":[]},{"id":"1e760614817dad6e","type":"switch","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"user handler","property":"req.params.path2","propertyType":"msg","rules":[{"t":"eq","v":"send","vt":"str"},{"t":"eq","v":"register","vt":"str"},{"t":"eq","v":"verify","vt":"str"},{"t":"eq","v":"login","vt":"str"},{"t":"eq","v":"dontspamme","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":6,"x":2138.895950317383,"y":1328.8890571594238,"wires":[["ade7b5712da4f502"],["627985f8a52639b4"],["349c67fcf6513cf3"],["46453dd4dcc215e7"],["353d91dbcc25531f"],["d80f6bfeaec940de"]]},{"id":"627985f8a52639b4","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 11","mode":"link","links":["142126c28ee25935"],"x":2350.500244140625,"y":1288.4171142578125,"wires":[]},{"id":"68ec96b6342d3dbd","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 12","mode":"link","links":["ea533ff22bb9c6f9"],"x":2886.5,"y":1232.41357421875,"wires":[]},{"id":"e651fa2e6bc6cf29","type":"http in","z":"40ea5f2aea6592ae","g":"4018e038c15bd294","name":"","url":"/api/:path1/:path2/:path3/:path4","method":"post","upload":false,"swaggerDoc":"","x":691,"y":722.8888549804688,"wires":[["48cd9aa96f7d1d8b"]]},{"id":"ade7b5712da4f502","type":"switch","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"/user/send handler","property":"req.params.path3","propertyType":"msg","rules":[{"t":"eq","v":"verify","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2665.896240234375,"y":1205.88916015625,"wires":[["0a29338b52b13f31"],["cfe518eea648cfe3"]]},{"id":"0a29338b52b13f31","type":"switch","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"/user/send/verify handler","property":"req.params.path4","propertyType":"msg","rules":[{"t":"eq","v":"email","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":3164.8964233398438,"y":1196.889102935791,"wires":[["fb24616382b60b38"],["abc3f4590b0a78c6"]]},{"id":"fb24616382b60b38","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 13","mode":"link","links":["30f35c3706f7e73a"],"x":3447.895751953125,"y":1190.4169311523438,"wires":[]},{"id":"303afc037a9b5e76","type":"http in","z":"40ea5f2aea6592ae","g":"4018e038c15bd294","name":"","url":"/api/:path1/:path2/:path3/:path4","method":"get","upload":false,"swaggerDoc":"","x":682,"y":1059.8891429901123,"wires":[["48cd9aa96f7d1d8b"]]},{"id":"46453dd4dcc215e7","type":"switch","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"/user/login handler","property":"req.params.path3","propertyType":"msg","rules":[{"t":"eq","v":"email","vt":"str"},{"t":"eq","v":"loginlink","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":2667.896728515625,"y":1367.889536857605,"wires":[["5b5c966a1a395882"],["0b3e9d820c4adae1"],["cfe518eea648cfe3"]]},{"id":"b1d61f03a3a9d567","type":"comment","z":"40ea5f2aea6592ae","name":":path1 Handlers","info":"","x":1786.4445571899414,"y":453.7535400390625,"wires":[]},{"id":"3943db41248186a2","type":"comment","z":"40ea5f2aea6592ae","name":":path2 Handlers","info":"","x":2136.895767211914,"y":453.7535400390625,"wires":[]},{"id":"ec8a692c8b207a1a","type":"comment","z":"40ea5f2aea6592ae","name":":path3 Handlers","info":"","x":2676.896026611328,"y":453.7535400390625,"wires":[]},{"id":"066665534de25933","type":"comment","z":"40ea5f2aea6592ae","name":":path4 Handlers","info":"","x":3176.89599609375,"y":453.7535400390625,"wires":[]},{"id":"5b5c966a1a395882","type":"switch","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"/user/login/email handler","property":"req.params.path4","propertyType":"msg","rules":[{"t":"istype","v":"undefined","vt":"undefined"},{"t":"eq","v":"send","vt":"str"},{"t":"eq","v":"verify","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":4,"x":3170.89599609375,"y":1351.8892211914062,"wires":[["acbc887acc9963d3"],["9cccce993a7d460f"],["b482c43545f18102"],["abc3f4590b0a78c6"]]},{"id":"acbc887acc9963d3","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 14","mode":"link","links":["8fb5538bb33154af"],"x":3447.895751953125,"y":1292.4204511642456,"wires":[]},{"id":"9cccce993a7d460f","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 15","mode":"link","links":["654a727d5e73414e"],"x":3447.895751953125,"y":1347.8891143798828,"wires":[]},{"id":"b482c43545f18102","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 16","mode":"link","links":["317a9744536713d7"],"x":3447.895751953125,"y":1394.8891620635986,"wires":[]},{"id":"abc3f4590b0a78c6","type":"link out","z":"40ea5f2aea6592ae","g":"487c8f7449f90598","name":"NOT FOUND","mode":"link","links":["cc0d78a673304144"],"x":3384.896240234375,"y":1596.4265775680542,"wires":[]},{"id":"cfe518eea648cfe3","type":"link out","z":"40ea5f2aea6592ae","g":"487c8f7449f90598","name":"NOT FOUND","mode":"link","links":["cc0d78a673304144"],"x":2839.8958740234375,"y":1596.4265775680542,"wires":[]},{"id":"0cd28b47ca230b20","type":"switch","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"bid handler","property":"req.params.path2","propertyType":"msg","rules":[{"t":"regex","v":"^[a-z0-9-]{36}$","vt":"str","case":false},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2113.89599609375,"y":779.8892211914062,"wires":[["4b7ea8384bd26f06"],["575c4dd631dbe29d"]]},{"id":"4b7ea8384bd26f06","type":"function","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"set uuid parameter","func":"msg.req.params[\"uuid\"] = msg.req.params.path2;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2437.34033203125,"y":770.8890075683594,"wires":[["8b28734e016e428f"]]},{"id":"8b28734e016e428f","type":"link out","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"link out 18","mode":"link","links":["5454979b74efae5c"],"x":2590.896059036255,"y":771.4203195571899,"wires":[]},{"id":"0b3e9d820c4adae1","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 30","mode":"link","links":["3723b83281660ef9"],"x":2886.5,"y":1368.8682661056519,"wires":[]},{"id":"349c67fcf6513cf3","type":"switch","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"/user/verify handler","property":"req.params.path3","propertyType":"msg","rules":[{"t":"istype","v":"undefined","vt":"undefined"},{"t":"eq","v":"resend","vt":"str"},{"t":"eq","v":"linkdata","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":4,"x":2665.5625534057617,"y":1281.4445123672485,"wires":[["68ec96b6342d3dbd"],["762de3a1ad95e96e"],["3ee6997d3ccde613"],["cfe518eea648cfe3"]]},{"id":"3ee6997d3ccde613","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 31","mode":"link","links":["87bcec7ef2a78fca"],"x":2886.5,"y":1314.9758911132812,"wires":[]},{"id":"667c3a588eff6983","type":"http response","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"","statusCode":"","headers":{},"x":3379.0072479248047,"y":1145.7777948379517,"wires":[]},{"id":"7529a56b38cde0b4","type":"function","z":"40ea5f2aea6592ae","name":"check auth","func":"\nif (msg.req.get(\"X-Auth\") == env.get(\"API_TOKEN\")) {\n    msg.status = \"ok\"\n} else {\n    msg.status = \"auth token mismatch\";\n    msg.req_token = msg.req.get(\"X-Auth\");\n    msg.our_token = env.get(\"API_TOKEN\");\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1373.4446411132812,"y":1184.7995796203613,"wires":[["910a405581c51b0e","970b6dc7d2146875"]]},{"id":"910a405581c51b0e","type":"switch","z":"40ea5f2aea6592ae","name":"","property":"status","propertyType":"msg","rules":[{"t":"eq","v":"ok","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":1166.0078125,"y":1370.1563110351562,"wires":[["b845467f255b0c8d"],["5f9969817f9c403d"]]},{"id":"970b6dc7d2146875","type":"debug","z":"40ea5f2aea6592ae","name":"AUTH DEBUG","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1572.4479522705078,"y":1079.2743,"wires":[]},{"id":"714f7b2a4a8ba90a","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 33","mode":"link","links":["2349281462e6046f"],"x":2350.500244140625,"y":1129.5244140625,"wires":[]},{"id":"b845467f255b0c8d","type":"change","z":"40ea5f2aea6592ae","name":"","rules":[{"t":"set","p":"origpayload","pt":"msg","to":"payload","tot":"msg","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":1370,"y":1363,"wires":[["45a940ec09abc397"]]},{"id":"353d91dbcc25531f","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 38","mode":"link","links":["ab0aaf85f16dbce9"],"x":2350.500244140625,"y":1370,"wires":[]},{"id":"8f147e1970be0c60","type":"http in","z":"40ea5f2aea6592ae","d":true,"g":"4018e038c15bd294","name":"","url":"/:path1","method":"post","upload":false,"swaggerDoc":"","x":611,"y":981.0000858306885,"wires":[["a2a7b683c264dd2a"]]},{"id":"42c7c23e6ce4e3a4","type":"switch","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"/users/:uuid/ handler","property":"req.params.path3","propertyType":"msg","rules":[{"t":"istype","v":"undefined","vt":"undefined"},{"t":"eq","v":"proposals","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":2661.000011444092,"y":657.0000553131104,"wires":[["6e2aa87058c9ca31"],["7763efbb9695e7e8"],["9298d66291096b56"]]},{"id":"9298d66291096b56","type":"link out","z":"40ea5f2aea6592ae","g":"2ba8206c046d35e7","name":"link out 41","mode":"link","links":["cc0d78a673304144"],"x":2823.5,"y":910.444580078125,"wires":[]},{"id":"89b2b92c371d90c8","type":"function","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"set uuid parameter","func":"msg.req.params[\"uuid\"] = msg.req.params.path2;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2444.000011444092,"y":656.0000553131104,"wires":[["42c7c23e6ce4e3a4"]]},{"id":"7763efbb9695e7e8","type":"link out","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"link out 42","mode":"link","links":["66e4187b8646b82e"],"x":2927.500011444092,"y":680.0000553131104,"wires":[]},{"id":"6e2aa87058c9ca31","type":"link out","z":"40ea5f2aea6592ae","g":"2d13d01b3ef30bc0","name":"link out 43","mode":"link","links":["09089e06e0208be6"],"x":2927.500011444092,"y":643.0000553131104,"wires":[]},{"id":"c49f0fc343b113fc","type":"link out","z":"40ea5f2aea6592ae","g":"487c8f7449f90598","name":"NOT FOUND","mode":"link","links":["cc0d78a673304144"],"x":1982,"y":1596.4265775680542,"wires":[]},{"id":"54b96e96d686e24a","type":"link out","z":"40ea5f2aea6592ae","g":"2ba8206c046d35e7","name":"link out 44","mode":"link","links":["cc0d78a673304144"],"x":1962,"y":910.444580078125,"wires":[]},{"id":"762de3a1ad95e96e","type":"link out","z":"40ea5f2aea6592ae","g":"b3ca5ea8fb84a877","name":"link out 61","mode":"link","links":["6aa9ebe23a27c971"],"x":2886.5,"y":1274,"wires":[]},{"id":"48cd9aa96f7d1d8b","type":"link out","z":"40ea5f2aea6592ae","name":"[bnbc] requests in","mode":"link","links":["30e1ed67843fb6cc","9ae0d1fb530e5662"],"x":1375,"y":849,"wires":[]},{"id":"9ae0d1fb530e5662","type":"link in","z":"40ea5f2aea6592ae","name":"[bnbc] request handler","links":["4aae6c01a34572d0","48cd9aa96f7d1d8b"],"x":1257,"y":1189,"wires":[["7529a56b38cde0b4"]]}]