[{"id":"8aa25bbe07c4a820","type":"subflow","name":"LED","info":"","category":"","in":[{"x":566,"y":167,"wires":[{"id":"41a0b4750e695e82"}]}],"out":[{"x":973,"y":219,"wires":[{"id":"41a0b4750e695e82","port":0}]}],"env":[],"meta":{},"color":"#FFF","icon":"node-red/light.svg","status":{"x":946,"y":146,"wires":[{"id":"84d73554d7c2de56","port":0}]}},{"id":"41a0b4750e695e82","type":"function","z":"8aa25bbe07c4a820","name":" ","func":"if ( msg.action == \"dotmatrix\") {\n    /*\n     * 16px by 16px, column major, big endian. @ http://dotmatrixtool.com \n     */\n    var uint_8 = \n        [\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // spacer \n\n            0xf8, 0x00, 0x40, 0x00, 0x20, 0x00, 0xf8, 0x00, // NODE\n            0x00, 0x00, 0x70, 0x00, 0x88, 0x00, 0x70, 0x00, \n            0x00, 0x00, 0xf8, 0x00, 0x88, 0x00, 0x70, 0x00, \n            0x00, 0x00, 0xf8, 0x00, 0xa8, 0x00, 0x88, 0x00, \n            \n            0x00, 0x00, 0x20, 0x00, 0x20, 0x00, 0x20, 0x00, // minus\n            0x00, 0x00,\n            \n            0xf8, 0x00, 0xa0, 0x00, 0x58, 0x00, 0x00, 0x00, // RED!\n            0xf8, 0x00, 0xa8, 0x00, 0x88, 0x00, 0x00, 0x00, \n            0xf8, 0x00, 0x88, 0x00, 0x70, 0x00, 0x00, 0x00, \n            0xe8, 0x00, \n            \n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // spacer\n        ];\n\n    var binaryData = uint_8.map((d) => { return (\"000000000\" + d.toString(2)).slice(-8) })\n\n    var cidx = ((msg.column % (uint_8.length/2))*2) + (msg.row > 7 ? 1 : 0);\n    var ridx = msg.row % 8;\n\n    if ( !this.context.get(\"myrow\") ) { this.context.set(\"myrow\", msg.row) }\n    if (!this.context.get(\"mycolumn\")) { this.context.set(\"mycolumn\", msg.column)}\n    \n    var myColumn = this.context.get(\"mycolumn\")\n    var myRow = this.context.get(\"myrow\")\n\n    setTimeout(() => {\n        node.status({\n            fill: binaryData[cidx][ridx] == \"1\" ? \"red\" : \"grey\",\n            shape: \"dot\",\n            text: msg.verbose ? \"c\" + myColumn + \"r\" + myRow : \"\"\n        })\n    }, 250);\n\n    msg.rowdata.push({\n        col: myColumn, \n        row: myRow,\n        val: binaryData[cidx][ridx] == \"1\"\n    })\n}\n\nmsg.column += 1;\n\nif (!this.context.get(\"stop\") && msg.action == \"stop\") {\n    this.context.set(\"stop\", true);\n\n    node.status({fill: \"green\", shape: \"dot\", text: \"stopping\"})\n    \n    var ctxt = this.context;\n    setTimeout( () => {\n        node.status({});\n        ctxt.set(\"stop\", false)\n        ctxt.set(\"mycolumn\", false)\n        ctxt.set(\"myrow\", false)\n    },2000);\n\n    return msg;\n}\n\nif ( !this.context.get(\"stop\") ) {\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":733,"y":260,"wires":[[]],"icon":"node-red/light.svg"},{"id":"84d73554d7c2de56","type":"status","z":"8aa25bbe07c4a820","name":"","scope":["41a0b4750e695e82"],"x":734,"y":179,"wires":[[]]},{"id":"81d46dabe68094e4","type":"tab","label":"[I2C] Ticker using Scroll pHAT","disabled":false,"info":"::: aim\n\nTo create a message scroller (aka, ticker) using the [Scroll pHAT](https://github.com/pimoroni/scroll-phat) connected to a Raspberry Pi. \n\n:::\n\n::: palette\n\n- [node-red-contrib-i2c](https://flows.nodered.org/node/node-red-contrib-i2c)\n\n:::\n\n\n### Flow Explanation\n\nThis is a combination of two other flows:\n\n- [Experimental scroller flow](https://flowhub.org/f/18a539afac758c61) that simulates a ticker in Node-RED, and\n- [I2C-based Scroll pHAT](https://flowhub.org/f/be2109bba90b6c5a) flow that uses the dashboard to make toggling LEDs easy.\n\nThis flows updates the Scroll pHAT to make it look like a scroller is happening. Basically the flow computes each frame using the <a class=\"ahl-group-only\" data-ids=\"e993b7f998fbec7d\">LED nodes</a>.\n\nThis flow comes with a Subflow that contains the content that is scrolled across the screen.\n","env":[]},{"id":"d652d4252503fe67","type":"group","z":"81d46dabe68094e4","name":"mode must be 3","style":{"label":true},"nodes":["cc3d51d76f7179f1","bfcc911c0fb1f030","3f86b15127dfcb42","228a0977a6c5031f","6b92d7b66993f06c","1e4f2a41918e023e","f93c334edfe2ffb2","e331b9804652a86d","e808a9451f2f8e36","2db3fca5e3af2279"],"x":366,"y":842,"w":424,"h":481},{"id":"172b914432e0f5bf","type":"group","z":"81d46dabe68094e4","name":"brightness of display","style":{"label":true},"nodes":["3a582d5c43ac064e","2f333be7f399ebf7","bf7fb8c8d803df33","e8eca45acdcb1707","820963cae3035e02","7e2e9764ef85f17d","c0004b6f2a13b75c","31c455aadc277801","d51476110e0cb04a","857fbba242af03c8"],"x":869.5,"y":845,"w":422,"h":551},{"id":"e993b7f998fbec7d","type":"group","z":"81d46dabe68094e4","name":"LEDs simulation nodes","style":{"label":true},"nodes":["d83dc2f569f99c67","4d2340cde928fa5e","7ecb0b74ac611e0a","14462a5b2747601d","fa22490114ce9a4e","6cac54c583d05d5b","8126ce95263902ef","1dcbb2c2b9cb7749","8ec2c10bec8c9a9c","4a5c9399d25d4031","19adea3b2f5d7bda","2d7351040e7072b6","41eec5ec5aa0ff3c","1f5250566727f285","4549c2012cec1c42","f1069194b6292b26","154980aed19ca56f","4a0b8e37855c4615","b140fe2cfc7c02a2","f17288f52a32ab04","e7dd309cb90ff70d","76f1090417154a68","d378e2d7cec0dee5","e1671b194e222b8f","899f75743a3f76c3","a1c760661bc26b58","371d965fda300509","9cad47a58446d1eb","613b3cce23c6f12e","1be2dc8fe23e9d07","64058f7fba1494de","3ba08d8987786c3b","c7d150fe5b4dcf60","c9d387a4110008d0","eebabf01bfebbb02","366a4cdcc7ae08d3","a76176e8c3db172a","e33b915234f81301","be04bb038dd074f3","cdcbe8e85fcd276f","dbc72c6911d0f2e3","ff513da010d3465d","d3bdb4c25e42f5f2","99da6338d21fb6a5","919f33ae934412ea","7afc1d299b30906e","036753cdaa056b63","992a902ae15feab9","de160478d1ca7dab","8c3ad0cc52b60f9d","5b8253f2149d90b1","71077a235e3b91e3","699df6fcf5513ca6","1bd686c150a9f1bc","918f917b220b7440"],"x":760.6667307535809,"y":480.96826171875,"w":1290.3333333333335,"h":290},{"id":"01aa5046531669bc","type":"group","z":"81d46dabe68094e4","name":"prepare data for Scroll pHAT","style":{"label":true},"nodes":["f0cdd33a921e9d74","9c3dd5b285f1c3b5","c17ade5fc4db6788","f2aaaf81ac231855","13b77973128cd1e1","9c911549135f1f44","b1729054a59c7de6"],"x":2256.1631841659546,"y":198,"w":724.8368158340454,"h":244},{"id":"2d373838440fac9c","type":"group","z":"81d46dabe68094e4","name":"loop messages with delay","style":{"label":true},"nodes":["8e3e091ddb5ab2b1","04ab08d8b6b1800a","7672c12e6bf540f2","70f39e57bd783573","ebcfe1cdf53a556e","decb5117f7cb4b4c","375d2730d4a6fd70","71ce8cfbc4c97158","1466e8bc97a26a18","757ec2380e867abc","969eecf35b4981fb","6eca96ddb013e106","ce9495d833733b21","d581fdfcf29cc278","32100adb884b5984"],"x":2262,"y":555.6348876953125,"w":426.083740234375,"h":290},{"id":"6a6180491b1fa9cb","type":"junction","z":"81d46dabe68094e4","x":492.1459057331085,"y":247.6398903131485,"wires":[["00341a1857721413"]]},{"id":"b1729054a59c7de6","type":"junction","z":"81d46dabe68094e4","g":"01aa5046531669bc","x":2282.1631841659546,"y":346.28571116924286,"wires":[["f0cdd33a921e9d74","f2aaaf81ac231855"]]},{"id":"fb13d27d4a6bd989","type":"inject","z":"81d46dabe68094e4","name":"start ticker","props":[{"p":"action","v":"dotmatrix","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":371,"y":217.85714721679688,"wires":[["6a6180491b1fa9cb"]]},{"id":"d83dc2f569f99c67","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":837.6667307535809,"y":521.96826171875,"wires":[["4d2340cde928fa5e"]]},{"id":"4d2340cde928fa5e","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":951.4000640869144,"y":521.96826171875,"wires":[["7ecb0b74ac611e0a"]]},{"id":"7ecb0b74ac611e0a","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1065.1333974202475,"y":521.96826171875,"wires":[["14462a5b2747601d"]]},{"id":"14462a5b2747601d","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1178.8667307535807,"y":521.96826171875,"wires":[["fa22490114ce9a4e"]]},{"id":"fa22490114ce9a4e","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1292.6000640869142,"y":521.96826171875,"wires":[["6cac54c583d05d5b"]]},{"id":"6cac54c583d05d5b","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1406.3333974202478,"y":521.96826171875,"wires":[["8126ce95263902ef"]]},{"id":"8126ce95263902ef","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1520.066730753581,"y":521.96826171875,"wires":[["1dcbb2c2b9cb7749"]]},{"id":"1dcbb2c2b9cb7749","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1633.800064086914,"y":521.96826171875,"wires":[["8ec2c10bec8c9a9c"]]},{"id":"8ec2c10bec8c9a9c","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1747.5333974202476,"y":521.96826171875,"wires":[["4a5c9399d25d4031"]]},{"id":"4a5c9399d25d4031","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1861.2667307535812,"y":521.96826171875,"wires":[["19adea3b2f5d7bda"]]},{"id":"19adea3b2f5d7bda","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1975.0000640869143,"y":521.96826171875,"wires":[["b1729054a59c7de6","375d2730d4a6fd70"]]},{"id":"8e3e091ddb5ab2b1","type":"link out","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"link out 81","mode":"link","links":["e95f43eed3059bc5"],"x":2647.083740234375,"y":596.6348876953125,"wires":[]},{"id":"e95f43eed3059bc5","type":"link in","z":"81d46dabe68094e4","name":"link in 2","links":["8e3e091ddb5ab2b1"],"x":713.666748046875,"y":493.96832275390625,"wires":[["d83dc2f569f99c67"]]},{"id":"2d7351040e7072b6","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":837.6667307535809,"y":573.96826171875,"wires":[["41eec5ec5aa0ff3c"]]},{"id":"41eec5ec5aa0ff3c","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":951.4000640869144,"y":573.96826171875,"wires":[["1f5250566727f285"]]},{"id":"1f5250566727f285","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1065.1333974202475,"y":573.96826171875,"wires":[["4549c2012cec1c42"]]},{"id":"4549c2012cec1c42","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1178.8667307535807,"y":573.96826171875,"wires":[["f1069194b6292b26"]]},{"id":"f1069194b6292b26","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1292.6000640869142,"y":573.96826171875,"wires":[["154980aed19ca56f"]]},{"id":"154980aed19ca56f","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1406.3333974202478,"y":573.96826171875,"wires":[["4a0b8e37855c4615"]]},{"id":"4a0b8e37855c4615","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1520.066730753581,"y":573.96826171875,"wires":[["b140fe2cfc7c02a2"]]},{"id":"b140fe2cfc7c02a2","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1633.800064086914,"y":573.96826171875,"wires":[["f17288f52a32ab04"]]},{"id":"f17288f52a32ab04","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1747.5333974202476,"y":573.96826171875,"wires":[["e7dd309cb90ff70d"]]},{"id":"e7dd309cb90ff70d","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1861.2667307535812,"y":573.96826171875,"wires":[["76f1090417154a68"]]},{"id":"76f1090417154a68","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1975.0000640869143,"y":573.96826171875,"wires":[["b1729054a59c7de6","6eca96ddb013e106"]]},{"id":"04ab08d8b6b1800a","type":"link out","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"link out 82","mode":"link","links":["e85c61717925f2aa"],"x":2647.083740234375,"y":648.6348876953125,"wires":[]},{"id":"e85c61717925f2aa","type":"link in","z":"81d46dabe68094e4","name":"link in 3","links":["04ab08d8b6b1800a"],"x":713.666748046875,"y":545.9683227539062,"wires":[["2d7351040e7072b6"]]},{"id":"d378e2d7cec0dee5","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":836.6667307535809,"y":626.96826171875,"wires":[["e1671b194e222b8f"]]},{"id":"e1671b194e222b8f","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":950.4000640869144,"y":626.96826171875,"wires":[["899f75743a3f76c3"]]},{"id":"899f75743a3f76c3","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1064.1333974202475,"y":626.96826171875,"wires":[["a1c760661bc26b58"]]},{"id":"a1c760661bc26b58","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1177.8667307535807,"y":626.96826171875,"wires":[["371d965fda300509"]]},{"id":"371d965fda300509","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1291.6000640869142,"y":626.96826171875,"wires":[["9cad47a58446d1eb"]]},{"id":"9cad47a58446d1eb","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1405.3333974202478,"y":626.96826171875,"wires":[["613b3cce23c6f12e"]]},{"id":"613b3cce23c6f12e","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1519.066730753581,"y":626.96826171875,"wires":[["1be2dc8fe23e9d07"]]},{"id":"1be2dc8fe23e9d07","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1632.800064086914,"y":626.96826171875,"wires":[["64058f7fba1494de"]]},{"id":"64058f7fba1494de","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1746.5333974202476,"y":626.96826171875,"wires":[["3ba08d8987786c3b"]]},{"id":"3ba08d8987786c3b","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1860.2667307535812,"y":626.96826171875,"wires":[["c7d150fe5b4dcf60"]]},{"id":"c7d150fe5b4dcf60","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1974.0000640869143,"y":626.96826171875,"wires":[["b1729054a59c7de6","ce9495d833733b21"]]},{"id":"7672c12e6bf540f2","type":"link out","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"link out 83","mode":"link","links":["b509233749810b13"],"x":2647.083740234375,"y":701.6348876953125,"wires":[]},{"id":"b509233749810b13","type":"link in","z":"81d46dabe68094e4","name":"link in 4","links":["7672c12e6bf540f2"],"x":713.666748046875,"y":598.9683227539062,"wires":[["d378e2d7cec0dee5"]]},{"id":"c9d387a4110008d0","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":836.6667307535809,"y":678.96826171875,"wires":[["eebabf01bfebbb02"]]},{"id":"eebabf01bfebbb02","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":950.4000640869144,"y":678.96826171875,"wires":[["366a4cdcc7ae08d3"]]},{"id":"366a4cdcc7ae08d3","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1064.1333974202475,"y":678.96826171875,"wires":[["a76176e8c3db172a"]]},{"id":"a76176e8c3db172a","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1177.8667307535807,"y":678.96826171875,"wires":[["e33b915234f81301"]]},{"id":"e33b915234f81301","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1291.6000640869142,"y":678.96826171875,"wires":[["be04bb038dd074f3"]]},{"id":"be04bb038dd074f3","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1405.3333974202478,"y":678.96826171875,"wires":[["cdcbe8e85fcd276f"]]},{"id":"cdcbe8e85fcd276f","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1519.066730753581,"y":678.96826171875,"wires":[["dbc72c6911d0f2e3"]]},{"id":"dbc72c6911d0f2e3","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1632.800064086914,"y":678.96826171875,"wires":[["ff513da010d3465d"]]},{"id":"ff513da010d3465d","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1746.5333974202476,"y":678.96826171875,"wires":[["d3bdb4c25e42f5f2"]]},{"id":"d3bdb4c25e42f5f2","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1860.2667307535812,"y":678.96826171875,"wires":[["99da6338d21fb6a5"]]},{"id":"99da6338d21fb6a5","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1974.0000640869143,"y":678.96826171875,"wires":[["b1729054a59c7de6","d581fdfcf29cc278"]]},{"id":"70f39e57bd783573","type":"link out","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"link out 84","mode":"link","links":["9ad2018360a1bb68"],"x":2647.083740234375,"y":753.6348876953125,"wires":[]},{"id":"9ad2018360a1bb68","type":"link in","z":"81d46dabe68094e4","name":"link in 5","links":["70f39e57bd783573"],"x":713.666748046875,"y":650.9683227539062,"wires":[["c9d387a4110008d0"]]},{"id":"919f33ae934412ea","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":836.6667307535809,"y":729.96826171875,"wires":[["7afc1d299b30906e"]]},{"id":"7afc1d299b30906e","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":950.4000640869144,"y":729.96826171875,"wires":[["036753cdaa056b63"]]},{"id":"036753cdaa056b63","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1064.1333974202475,"y":729.96826171875,"wires":[["992a902ae15feab9"]]},{"id":"992a902ae15feab9","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1177.8667307535807,"y":729.96826171875,"wires":[["de160478d1ca7dab"]]},{"id":"de160478d1ca7dab","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1291.6000640869142,"y":729.96826171875,"wires":[["8c3ad0cc52b60f9d"]]},{"id":"8c3ad0cc52b60f9d","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1405.3333974202478,"y":729.96826171875,"wires":[["5b8253f2149d90b1"]]},{"id":"5b8253f2149d90b1","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1519.066730753581,"y":729.96826171875,"wires":[["71077a235e3b91e3"]]},{"id":"71077a235e3b91e3","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1632.800064086914,"y":729.96826171875,"wires":[["699df6fcf5513ca6"]]},{"id":"699df6fcf5513ca6","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1746.5333974202476,"y":729.96826171875,"wires":[["1bd686c150a9f1bc"]]},{"id":"1bd686c150a9f1bc","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1860.2667307535812,"y":729.96826171875,"wires":[["918f917b220b7440"]]},{"id":"918f917b220b7440","type":"subflow:8aa25bbe07c4a820","z":"81d46dabe68094e4","g":"e993b7f998fbec7d","name":" ","x":1974.0000640869143,"y":729.96826171875,"wires":[["b1729054a59c7de6","32100adb884b5984"]]},{"id":"ebcfe1cdf53a556e","type":"link out","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"link out 85","mode":"link","links":["ab5ce5ab4e400d31"],"x":2647.083740234375,"y":804.6348876953125,"wires":[]},{"id":"ab5ce5ab4e400d31","type":"link in","z":"81d46dabe68094e4","name":"link in 6","links":["ebcfe1cdf53a556e"],"x":713.666748046875,"y":701.9683227539062,"wires":[["919f33ae934412ea"]]},{"id":"c7d3a93519a0d1b2","type":"change","z":"81d46dabe68094e4","name":"","rules":[{"t":"set","p":"row","pt":"msg","to":"msg.row + 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":433.6666943868004,"y":521.6348991394043,"wires":[["3c628b068a25ba14","d83dc2f569f99c67"]]},{"id":"3c628b068a25ba14","type":"change","z":"81d46dabe68094e4","name":"","rules":[{"t":"set","p":"row","pt":"msg","to":"msg.row + 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":433.6666943868004,"y":573.4620570712619,"wires":[["c4c49637da48f64c","2d7351040e7072b6"]]},{"id":"c4c49637da48f64c","type":"change","z":"81d46dabe68094e4","name":"","rules":[{"t":"set","p":"row","pt":"msg","to":"msg.row + 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":433.6666943868004,"y":625.2892150031196,"wires":[["96b56eb131a2f252","d378e2d7cec0dee5"]]},{"id":"96b56eb131a2f252","type":"change","z":"81d46dabe68094e4","name":"","rules":[{"t":"set","p":"row","pt":"msg","to":"msg.row + 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":433.6666943868004,"y":677.1163729349772,"wires":[["a7413cd772cb0ae2","c9d387a4110008d0"]]},{"id":"a7413cd772cb0ae2","type":"change","z":"81d46dabe68094e4","name":"","rules":[{"t":"set","p":"row","pt":"msg","to":"msg.row + 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":433.6666943868004,"y":728.9435308668349,"wires":[["919f33ae934412ea"]]},{"id":"00341a1857721413","type":"change","z":"81d46dabe68094e4","name":"verbose?","rules":[{"t":"set","p":"verbose","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":434.444580078125,"y":347.301513671875,"wires":[["ba8ebc3c029329e6"]]},{"id":"cde5184762b5e151","type":"change","z":"81d46dabe68094e4","name":"row & column","rules":[{"t":"set","p":"column","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"row","pt":"msg","to":"-1","tot":"num"},{"t":"set","p":"rowdata","pt":"msg","to":"[]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":429.00013732910156,"y":446.301513671875,"wires":[["c7d3a93519a0d1b2"]]},{"id":"decb5117f7cb4b4c","type":"delay","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"","pauseType":"delayv","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2541,"y":596.6348876953125,"wires":[["8e3e091ddb5ab2b1"]]},{"id":"375d2730d4a6fd70","type":"change","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"","rules":[{"t":"set","p":"column","pt":"msg","to":"msg.column-10","tot":"jsonata"},{"t":"set","p":"rowdata","pt":"msg","to":"[]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2368,"y":596.9999694824219,"wires":[["decb5117f7cb4b4c"]]},{"id":"f0cdd33a921e9d74","type":"join","z":"81d46dabe68094e4","g":"01aa5046531669bc","name":"","mode":"custom","build":"array","property":"rowdata","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"3","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2371,"y":251,"wires":[["9c3dd5b285f1c3b5"]]},{"id":"9c3dd5b285f1c3b5","type":"function","z":"81d46dabe68094e4","g":"01aa5046531669bc","name":"prepare data and store \\n state into the flow context","func":"/* Pixels are columns first:\n  [ c1, c2, c3 .... c11, 255 ]\nwhere each 'c' is an array of 5 values representing the rows.\n*/\n\nvar pixels = flow.get(\"pixels\") || [1,2,3,4,5,6,7,8,9,10,11].map(function (d) { return new Array(0,0,0,0,0) })\n\nfor (var idx = 0; idx < msg.rowdata.length; idx++) {\n  for (var jdx = 0; jdx < msg.rowdata[idx].length; jdx++) {\n    var p = msg.rowdata[idx][jdx];\n    pixels[p.col - 1][5 - p.row] = p.val ? 1 : 0;\n  }\n}\n\nflow.set('pixels', pixels);\n\nmsg.payload = [...pixels.map( (vals) => {\n  return eval(\"0b\" + vals.join(\"\"))\n}), 255];\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2572,"y":251,"wires":[["c17ade5fc4db6788"]]},{"id":"c17ade5fc4db6788","type":"i2c out","z":"81d46dabe68094e4","g":"01aa5046531669bc","name":"pixel","busno":"1","address":"96","command":"1","payload":"payload","payloadType":"msg","count":"12","x":2905,"y":250,"wires":[[]]},{"id":"71ce8cfbc4c97158","type":"delay","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"","pauseType":"delayv","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2541,"y":648.4761657714844,"wires":[["04ab08d8b6b1800a"]]},{"id":"1466e8bc97a26a18","type":"delay","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"","pauseType":"delayv","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2541,"y":700.3174438476562,"wires":[["7672c12e6bf540f2"]]},{"id":"757ec2380e867abc","type":"delay","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"","pauseType":"delayv","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2541,"y":752.1587219238281,"wires":[["70f39e57bd783573"]]},{"id":"969eecf35b4981fb","type":"delay","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"","pauseType":"delayv","timeout":"300","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2541,"y":804,"wires":[["ebcfe1cdf53a556e"]]},{"id":"ba8ebc3c029329e6","type":"change","z":"81d46dabe68094e4","name":"delay (milliseconds)","rules":[{"t":"set","p":"delay","pt":"msg","to":"150","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":437,"y":396,"wires":[["cde5184762b5e151"]]},{"id":"cc3d51d76f7179f1","type":"i2c out","z":"81d46dabe68094e4","g":"d652d4252503fe67","name":"mode","busno":"1","address":"96","command":"0","payload":"payload","payloadType":"msg","count":"1","x":714,"y":1083,"wires":[[]]},{"id":"bfcc911c0fb1f030","type":"inject","z":"81d46dabe68094e4","g":"d652d4252503fe67","name":"1","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"1","payloadType":"num","x":462,"y":932.875,"wires":[["cc3d51d76f7179f1"]]},{"id":"3f86b15127dfcb42","type":"inject","z":"81d46dabe68094e4","g":"d652d4252503fe67","name":"2","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"2","payloadType":"num","x":462,"y":982.75,"wires":[["cc3d51d76f7179f1"]]},{"id":"228a0977a6c5031f","type":"inject","z":"81d46dabe68094e4","g":"d652d4252503fe67","name":"0","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"0","payloadType":"num","x":462,"y":883,"wires":[["cc3d51d76f7179f1"]]},{"id":"6b92d7b66993f06c","type":"inject","z":"81d46dabe68094e4","g":"d652d4252503fe67","name":"3","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"3","payloadType":"num","x":462,"y":1032.625,"wires":[["cc3d51d76f7179f1"]]},{"id":"1e4f2a41918e023e","type":"inject","z":"81d46dabe68094e4","g":"d652d4252503fe67","name":"4","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"4","payloadType":"num","x":462,"y":1082.5,"wires":[["cc3d51d76f7179f1"]]},{"id":"f93c334edfe2ffb2","type":"inject","z":"81d46dabe68094e4","g":"d652d4252503fe67","name":"5","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"5","payloadType":"num","x":462,"y":1132.375,"wires":[["cc3d51d76f7179f1"]]},{"id":"e331b9804652a86d","type":"inject","z":"81d46dabe68094e4","g":"d652d4252503fe67","name":"6","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"6","payloadType":"num","x":462,"y":1182.25,"wires":[["cc3d51d76f7179f1"]]},{"id":"e808a9451f2f8e36","type":"inject","z":"81d46dabe68094e4","g":"d652d4252503fe67","name":"7","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"7","payloadType":"num","x":462,"y":1232.125,"wires":[["cc3d51d76f7179f1"]]},{"id":"2db3fca5e3af2279","type":"inject","z":"81d46dabe68094e4","g":"d652d4252503fe67","name":"8","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"8","payloadType":"num","x":462,"y":1282,"wires":[["cc3d51d76f7179f1"]]},{"id":"3a582d5c43ac064e","type":"i2c out","z":"81d46dabe68094e4","g":"172b914432e0f5bf","name":"brightness","busno":"1","address":"96","command":"25","payload":"payload","payloadType":"msg","count":"1","x":1195.5,"y":1098,"wires":[[]]},{"id":"2f333be7f399ebf7","type":"inject","z":"81d46dabe68094e4","g":"172b914432e0f5bf","name":"1","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"1","payloadType":"num","x":965.5,"y":944.625,"wires":[["3a582d5c43ac064e"]]},{"id":"bf7fb8c8d803df33","type":"inject","z":"81d46dabe68094e4","g":"172b914432e0f5bf","name":"2","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"2","payloadType":"num","x":965.5,"y":1003.25,"wires":[["3a582d5c43ac064e"]]},{"id":"e8eca45acdcb1707","type":"inject","z":"81d46dabe68094e4","g":"172b914432e0f5bf","name":"0","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"0","payloadType":"num","x":965.5,"y":886,"wires":[["3a582d5c43ac064e"]]},{"id":"820963cae3035e02","type":"inject","z":"81d46dabe68094e4","g":"172b914432e0f5bf","name":"3","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"3","payloadType":"num","x":965.5,"y":1061.875,"wires":[["3a582d5c43ac064e"]]},{"id":"7e2e9764ef85f17d","type":"inject","z":"81d46dabe68094e4","g":"172b914432e0f5bf","name":"4","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"4","payloadType":"num","x":965.5,"y":1120.5,"wires":[["3a582d5c43ac064e"]]},{"id":"c0004b6f2a13b75c","type":"inject","z":"81d46dabe68094e4","g":"172b914432e0f5bf","name":"5","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"5","payloadType":"num","x":965.5,"y":1179.125,"wires":[["3a582d5c43ac064e"]]},{"id":"31c455aadc277801","type":"inject","z":"81d46dabe68094e4","g":"172b914432e0f5bf","name":"6","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"6","payloadType":"num","x":965.5,"y":1237.75,"wires":[["3a582d5c43ac064e"]]},{"id":"d51476110e0cb04a","type":"inject","z":"81d46dabe68094e4","g":"172b914432e0f5bf","name":"7","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"7","payloadType":"num","x":965.5,"y":1296.375,"wires":[["3a582d5c43ac064e"]]},{"id":"857fbba242af03c8","type":"inject","z":"81d46dabe68094e4","g":"172b914432e0f5bf","name":"8","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"8","payloadType":"num","x":965.5,"y":1355,"wires":[["3a582d5c43ac064e"]]},{"id":"5e0ee37688456c32","type":"inject","z":"81d46dabe68094e4","name":"stop!","props":[{"p":"action","v":"stop","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":358,"y":274,"wires":[["6a6180491b1fa9cb"]]},{"id":"f2aaaf81ac231855","type":"switch","z":"81d46dabe68094e4","g":"01aa5046531669bc","name":"if action stop?","property":"action","propertyType":"msg","rules":[{"t":"eq","v":"stop","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2447,"y":382,"wires":[["13b77973128cd1e1"]]},{"id":"13b77973128cd1e1","type":"delay","z":"81d46dabe68094e4","g":"01aa5046531669bc","name":"2 seconds delay","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":2638,"y":343,"wires":[["9c911549135f1f44"]]},{"id":"9c911549135f1f44","type":"change","z":"81d46dabe68094e4","g":"01aa5046531669bc","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"[0,0,0,0, 0,0,0,0, 0,0,0, 255]","tot":"json"},{"t":"delete","p":"pixels","pt":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":2782,"y":401,"wires":[["c17ade5fc4db6788"]]},{"id":"6eca96ddb013e106","type":"change","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"","rules":[{"t":"set","p":"column","pt":"msg","to":"msg.column-10","tot":"jsonata"},{"t":"set","p":"rowdata","pt":"msg","to":"[]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2368,"y":649,"wires":[["71ce8cfbc4c97158"]]},{"id":"ce9495d833733b21","type":"change","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"","rules":[{"t":"set","p":"column","pt":"msg","to":"msg.column-10","tot":"jsonata"},{"t":"set","p":"rowdata","pt":"msg","to":"[]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2368,"y":701,"wires":[["1466e8bc97a26a18"]]},{"id":"d581fdfcf29cc278","type":"change","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"","rules":[{"t":"set","p":"column","pt":"msg","to":"msg.column-10","tot":"jsonata"},{"t":"set","p":"rowdata","pt":"msg","to":"[]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2368,"y":752,"wires":[["757ec2380e867abc"]]},{"id":"32100adb884b5984","type":"change","z":"81d46dabe68094e4","g":"2d373838440fac9c","name":"","rules":[{"t":"set","p":"column","pt":"msg","to":"msg.column-10","tot":"jsonata"},{"t":"set","p":"rowdata","pt":"msg","to":"[]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2368,"y":804,"wires":[["969eecf35b4981fb"]]}]