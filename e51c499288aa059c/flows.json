[{"id":"74e1d54a72b1f8cd","type":"subflow","name":"dectree node - Ok!","info":"","category":"decision tree","in":[{"x":296,"y":250,"wires":[{"id":"4468a471e299714d"}]}],"out":[{"x":1312,"y":677,"wires":[{"id":"e383141557e2f6a2","port":0}]}],"env":[{"name":"question","type":"str","value":""}],"meta":{},"color":"#FFAAAA","outputLabels":["Ok"],"icon":"node-red/alert.svg"},{"id":"4468a471e299714d","type":"function","z":"74e1d54a72b1f8cd","name":"define and stringify choices","func":"msg.question = env.get(\"question\")\n\nmsg.choices = [\n    {\n        value: \"1\",\n        text: \"Ok\"\n    },\n]\nmsg._choices = JSON.stringify(msg.choices)\n\n// TODO create a link to the node that represents this\n// TODO question. For that we need the httpAdminRoot since\n// TODO the deeplink path is:\n//   http://noderedhost:1880/cfg/#node/f830b7f80c9107ce\n// Node id we can get:\n//    node.id.split(\"-\")[0]\n// the 'cfg' which is the httpAdminRoot is what we need to \n// create a deep link to the node.\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":695,"y":401,"wires":[["b0ca7893e9dedd02"]]},{"id":"b0ca7893e9dedd02","type":"link call","z":"74e1d54a72b1f8cd","name":"","links":["42fa137c805ffa57"],"linkType":"static","timeout":"30","x":822,"y":495,"wires":[["c96043a33cba85e9"]]},{"id":"c96043a33cba85e9","type":"switch","z":"74e1d54a72b1f8cd","name":"","property":"__linkSource","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":796,"y":587,"wires":[["e383141557e2f6a2"]]},{"id":"e383141557e2f6a2","type":"function","z":"74e1d54a72b1f8cd","name":"function 27","func":"let choices = JSON.parse(msg._choices);\n\nlet rAry = Array.from({ length: choices.length }, () => { \n    return undefined \n})\n\nfor ( var idx = 0 ; idx < choices.length; idx++ ) {\n    if ( msg.payload == choices[idx].value ) {\n        delete msg.payload;\n        delete msg.__linkSource;\n        delete msg._choices;\n        \n        rAry[idx] = msg;\n        return rAry;\n    }\n}\n\nreturn rAry.concat([msg]);","outputs":2,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":965,"y":687,"wires":[[],["6b283f3bd4981402"]]},{"id":"6b283f3bd4981402","type":"debug","z":"74e1d54a72b1f8cd","name":"NO CHOICE MATCHED","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1270,"y":784,"wires":[]},{"id":"0c2cdffaad661673","type":"catch","z":"74e1d54a72b1f8cd","name":"","scope":null,"uncaught":false,"x":1050,"y":231,"wires":[["1f6b03e353b95c79"]]},{"id":"1f6b03e353b95c79","type":"debug","z":"74e1d54a72b1f8cd","name":"debug 1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1357,"y":180,"wires":[]},{"id":"a834ee234dd774a1","type":"subflow","name":"dectree node - multi 2","info":"","category":"decision tree","in":[{"x":203,"y":111,"wires":[{"id":"b0cf62bfc2da327f"}]}],"out":[{"x":872,"y":542,"wires":[{"id":"05afe73cf7614e71","port":0}]},{"x":955,"y":653,"wires":[{"id":"05afe73cf7614e71","port":1}]}],"env":[{"name":"question","type":"str","value":""},{"name":"choice01","type":"str","value":""},{"name":"choice02","type":"str","value":""}],"meta":{},"color":"#3FADB5","icon":"node-red/switch.svg"},{"id":"b0cf62bfc2da327f","type":"function","z":"a834ee234dd774a1","name":"stringify choices","func":"msg.question = env.get(\"question\")\n\nmsg.choices = [\n    {\n        \"value\": \"1\",\n        \"text\": env.get(\"choice01\")\n    },\n    {\n        \"value\": \"2\",\n        \"text\": env.get(\"choice02\")\n    }\n\n]\n\n// avoid escaping problems with the texts by removing them. \n// this string is placed as a data element in a html tag ... encoding\n// is just painful in this case.\nmsg._choices = JSON.stringify(msg.choices.map( d => {\n    return { \"value\": d.value }\n}))\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":434,"y":372,"wires":[["b829684e0b149858"]]},{"id":"b829684e0b149858","type":"link call","z":"a834ee234dd774a1","name":"","links":["42fa137c805ffa57"],"linkType":"static","timeout":"30","x":434,"y":465,"wires":[["1392a550c68b0f16"]]},{"id":"1392a550c68b0f16","type":"switch","z":"a834ee234dd774a1","name":"","property":"__linkSource","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":437,"y":549,"wires":[["05afe73cf7614e71"]]},{"id":"05afe73cf7614e71","type":"function","z":"a834ee234dd774a1","name":"function 27","func":"let choices = JSON.parse(msg._choices);\n\nlet rAry = Array.from({ length: choices.length }, () => { \n    return undefined \n})\n\nfor ( var idx = 0 ; idx < choices.length; idx++ ) {\n    if ( msg.payload == choices[idx].value ) {\n        delete msg.payload;\n        delete msg.__linkSource;\n        delete msg._choices;\n        \n        rAry[idx] = msg;\n        return rAry;\n    }\n}\n\nreturn rAry.concat([msg]);","outputs":3,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":607,"y":657,"wires":[[],[],["67d468cf8c05398e"]]},{"id":"67d468cf8c05398e","type":"debug","z":"a834ee234dd774a1","name":"NO CHOICE MATCHED","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":809,"y":768,"wires":[]},{"id":"dfcb14ccf7d1f047","type":"catch","z":"a834ee234dd774a1","name":"","scope":null,"uncaught":false,"x":624,"y":146,"wires":[[]]},{"id":"af587bc01058b6fd","type":"subflow","name":"dectree node - multi 6","info":"","category":"decision tree","in":[{"x":317,"y":102,"wires":[{"id":"76f99d9a368f07e1"}]}],"out":[{"x":1272,"y":576,"wires":[{"id":"3ed6691bd7f39b03","port":0}]},{"x":1210.5999755859375,"y":615,"wires":[{"id":"3ed6691bd7f39b03","port":1}]},{"x":1273.199951171875,"y":644,"wires":[{"id":"3ed6691bd7f39b03","port":2}]},{"x":1210.5999755859375,"y":678,"wires":[{"id":"3ed6691bd7f39b03","port":3}]},{"x":1274.4000244140625,"y":703,"wires":[{"id":"3ed6691bd7f39b03","port":4}]},{"x":1210.5999755859375,"y":731,"wires":[{"id":"3ed6691bd7f39b03","port":5}]}],"env":[{"name":"question","type":"str","value":""},{"name":"choice01","type":"str","value":""},{"name":"choice02","type":"str","value":""},{"name":"choice03","type":"str","value":""},{"name":"choice04","type":"str","value":""},{"name":"choice05","type":"str","value":""},{"name":"choice06","type":"str","value":""}],"meta":{},"color":"#3FADB5","icon":"node-red/switch.svg"},{"id":"76f99d9a368f07e1","type":"function","z":"af587bc01058b6fd","name":"setup choices and msg","func":"msg.question = env.get( \"question\" )\n\nmsg.choices = [\n    {\n        \"value\": \"1\",\n        \"text\": env.get(\"choice01\")\n    },\n    {\n        \"value\": \"2\",\n        \"text\": env.get(\"choice02\")\n    },\n    {\n        \"value\": \"3\",\n        \"text\": env.get(\"choice03\")\n    },\n    {\n        \"value\": \"4\",\n        \"text\": env.get(\"choice04\")\n    },\n    {\n        \"value\": \"5\",\n        \"text\": env.get(\"choice05\")\n    },\n    {\n        \"value\": \"6\",\n        \"text\": env.get(\"choice06\")\n    }\n]\n\n// avoid escaping problems with the texts by removing them. \n// this string is placed as a data element in a html tag ... encoding\n// is just painful in this case.\nmsg._choices = JSON.stringify(msg.choices.map( d => {\n    return { \"value\": d.value }\n}))\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":578,"y":265,"wires":[["4c15b68d98a0144b"]]},{"id":"4c15b68d98a0144b","type":"link call","z":"af587bc01058b6fd","name":"","links":["42fa137c805ffa57"],"linkType":"static","timeout":"30","x":674,"y":414,"wires":[["2ca38b7247fe194f"]]},{"id":"2ca38b7247fe194f","type":"switch","z":"af587bc01058b6fd","name":"","property":"__linkSource","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":743,"y":569,"wires":[["3ed6691bd7f39b03"]]},{"id":"3ed6691bd7f39b03","type":"function","z":"af587bc01058b6fd","name":"function 27","func":"let choices = JSON.parse(msg._choices);\n\nlet rAry = Array.from({ length: choices.length }, () => { \n    return undefined \n})\n\nfor ( var idx = 0 ; idx < choices.length; idx++ ) {\n    if ( msg.payload == choices[idx].value ) {\n        delete msg.payload;\n        delete msg.__linkSource;\n        delete msg._choices;\n        \n        rAry[idx] = msg;\n        return rAry;\n    }\n}\n\nreturn rAry.concat([msg]);","outputs":7,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":902,"y":724,"wires":[[],[],[],[],[],[],["d1f39a4ee7705a39"]]},{"id":"d1f39a4ee7705a39","type":"debug","z":"af587bc01058b6fd","name":"NO CHOICE MATCHED","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1104,"y":835,"wires":[]},{"id":"af8c58f803eca466","type":"catch","z":"af587bc01058b6fd","name":"","scope":null,"uncaught":false,"x":1003,"y":255,"wires":[[]]},{"id":"6cf8708f9a09860e","type":"subflow","name":"dectree node - multi 4","info":"","category":"decision tree","in":[{"x":238,"y":145,"wires":[{"id":"2eda7d5dcbf01dbe"}]}],"out":[{"x":1154,"y":466,"wires":[{"id":"a18a60e14bbf6ad7","port":0}]},{"x":1214,"y":553,"wires":[{"id":"a18a60e14bbf6ad7","port":1}]},{"x":1273,"y":632,"wires":[{"id":"a18a60e14bbf6ad7","port":2}]},{"x":1252,"y":755,"wires":[{"id":"a18a60e14bbf6ad7","port":3}]}],"env":[{"name":"question","type":"str","value":""},{"name":"choice01","type":"str","value":""},{"name":"choice02","type":"str","value":""},{"name":"choice03","type":"str","value":""},{"name":"choice04","type":"str","value":""}],"meta":{},"color":"#3FADB5","icon":"node-red/switch.svg"},{"id":"854fd0f3ac5d7a91","type":"link call","z":"6cf8708f9a09860e","name":"","links":["42fa137c805ffa57"],"linkType":"static","timeout":"30","x":655,"y":472,"wires":[["4734652f33a73279"]]},{"id":"2eda7d5dcbf01dbe","type":"function","z":"6cf8708f9a09860e","name":"setup msg with question and choices","func":"msg.question = env.get(\"question\")\n\nmsg.choices = [\n    {\n        \"value\": \"1\",\n        \"text\": env.get(\"choice01\")\n    },\n    {\n        \"value\": \"2\",\n        \"text\": env.get(\"choice02\")\n    },\n    {\n        \"value\": \"3\",\n        \"text\": env.get(\"choice03\")\n    },\n    {\n        \"value\": \"4\",\n        \"text\": env.get(\"choice04\")\n    }\n];\n\n// avoid escaping problems with the texts by removing them. \n// this string is placed as a data element in a html tag ... encoding\n// is just painful in this case.\nmsg._choices = JSON.stringify(msg.choices.map( d => {\n    return { \"value\": d.value }\n}))\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":598,"y":354,"wires":[["854fd0f3ac5d7a91"]]},{"id":"4734652f33a73279","type":"switch","z":"6cf8708f9a09860e","name":"","property":"__linkSource","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":706,"y":584,"wires":[["a18a60e14bbf6ad7"]]},{"id":"a18a60e14bbf6ad7","type":"function","z":"6cf8708f9a09860e","name":"function 27","func":"let choices = JSON.parse(msg._choices);\n\nlet rAry = Array.from({ length: choices.length }, () => { \n    return undefined \n})\n\nfor ( var idx = 0 ; idx < choices.length; idx++ ) {\n    if ( msg.payload == choices[idx].value ) {\n        delete msg.payload;\n        delete msg.__linkSource;\n        delete msg._choices;\n        \n        rAry[idx] = msg;\n        return rAry;\n    }\n}\n\nreturn rAry.concat([msg]);","outputs":5,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":836,"y":750,"wires":[[],[],[],[],["04f605795b03a24c"]]},{"id":"04f605795b03a24c","type":"debug","z":"6cf8708f9a09860e","name":"NO CHOICE MATCHED","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1107,"y":883,"wires":[]},{"id":"5df0d3b6c6f34c1a","type":"catch","z":"6cf8708f9a09860e","name":"","scope":null,"uncaught":false,"x":1104,"y":46,"wires":[[]]},{"id":"104818a352e4dbd7","type":"subflow","name":"dectree node - Done/Result.","info":"","category":"decision tree","in":[{"x":198,"y":175,"wires":[{"id":"4adc25c3f4071a67"},{"id":"1f6121378b57e435"}]}],"out":[],"env":[{"name":"result","type":"str","value":""}],"meta":{},"color":"#87A980","icon":"font-awesome/fa-check"},{"id":"4adc25c3f4071a67","type":"change","z":"104818a352e4dbd7","name":"","rules":[{"t":"set","p":"question","pt":"msg","to":"result","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":421,"y":272,"wires":[["137eec287dc9b928"]]},{"id":"137eec287dc9b928","type":"function","z":"104818a352e4dbd7","name":"define and stringify choices","func":"msg.choices = [\n]\nmsg._choices = JSON.stringify(msg.choices)\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":721,"y":382,"wires":[["d270593519bddf9c"]]},{"id":"d270593519bddf9c","type":"link call","z":"104818a352e4dbd7","name":"","links":["42fa137c805ffa57"],"linkType":"static","timeout":"30","x":1027,"y":534,"wires":[[]]},{"id":"1f6121378b57e435","type":"change","z":"104818a352e4dbd7","name":"","rules":[{"t":"set","p":"enabled","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":461,"y":146,"wires":[["89e90816434341cc"]]},{"id":"89e90816434341cc","type":"link call","z":"104818a352e4dbd7","name":"","links":["cfcd2e897d5c0486"],"linkType":"static","timeout":"30","x":754,"y":98,"wires":[[]]},{"id":"fbfaa81b6a6dfb52","type":"catch","z":"104818a352e4dbd7","name":"","scope":null,"uncaught":false,"x":997,"y":47,"wires":[[]]},{"id":"08e99cbd5f4d9de5","type":"subflow","name":"dectree node - yes/no","info":"","category":"decision tree","in":[{"x":153,"y":137,"wires":[{"id":"546930450ce8938c"}]}],"out":[{"x":1109,"y":559,"wires":[{"id":"9e35b3119e821a39","port":0}]},{"x":1134,"y":655,"wires":[{"id":"9e35b3119e821a39","port":1}]}],"env":[{"name":"question","type":"str","value":""}],"meta":{},"color":"#E2D96E","outputLabels":["Yes","No"],"icon":"font-awesome/fa-question"},{"id":"7b93f6ae1b50b506","type":"link call","z":"08e99cbd5f4d9de5","name":"","links":["42fa137c805ffa57"],"linkType":"static","timeout":"30","x":603,"y":439,"wires":[["28402ef1afc40367"]]},{"id":"23bad6a3d8f3f08b","type":"debug","z":"08e99cbd5f4d9de5","name":"NO CHOICE MATCHED","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1119,"y":905,"wires":[]},{"id":"546930450ce8938c","type":"function","z":"08e99cbd5f4d9de5","name":"define and stringify choices","func":"msg.question = env.get(\"question\")\n\nmsg.choices = [\n    {\n        value: \"1\",\n        text: \"Yes\"\n    },\n    {\n        value: \"2\",\n        text: \"No\"\n    }\n]\nmsg._choices = JSON.stringify(msg.choices)\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":643,"y":329,"wires":[["7b93f6ae1b50b506"]]},{"id":"9e35b3119e821a39","type":"function","z":"08e99cbd5f4d9de5","name":"function 27","func":"let choices = JSON.parse(msg._choices);\n\nlet rAry = Array.from({ length: choices.length }, () => { \n    return undefined \n})\n\nfor ( var idx = 0 ; idx < choices.length; idx++ ) {\n    if ( msg.payload == choices[idx].value ) {\n        delete msg.payload;\n        delete msg.__linkSource;\n        delete msg._choices;\n        \n        rAry[idx] = msg;\n        return rAry;\n    }\n}\n\nreturn rAry.concat([msg]);","outputs":3,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":776,"y":631,"wires":[[],[],["23bad6a3d8f3f08b"]]},{"id":"28402ef1afc40367","type":"switch","z":"08e99cbd5f4d9de5","name":"","property":"__linkSource","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":676,"y":540,"wires":[["9e35b3119e821a39"]]},{"id":"1211ca9a99229556","type":"catch","z":"08e99cbd5f4d9de5","name":"","scope":null,"uncaught":false,"x":926,"y":105,"wires":[[]]},{"id":"e51c499288aa059c","type":"tab","label":"[Decision tree] Which Node-RED extension method should I use?","disabled":false,"info":"::: wip\n\nThis decision tree is not yet completeed and liable to change.\n\n:::\n\n::: aim\n\nCreate a decision tree to help decision making.\n\n:::\n\n::: requirements\n\n- [NodeDev package](https://flows.nodered.org/node/@gregoriusrippenstein/node-red-contrib-nodedev) for the PkgFile nodes.\n\n:::\n","env":[]},{"id":"6c956af2b71922a1","type":"group","z":"e51c499288aa059c","name":"Dashboard element for displaying the questions and buttons","style":{"label":true},"nodes":["e26a30ff2809e98b","0d73bc93ea491552","42fa137c805ffa57","021a75e9de1c8f9c","03a875dc9fc37e55","99db60304c670cc9"],"x":83.50003051757812,"y":1783.5001831054688,"w":982.3334655761719,"h":240.83319091796875},{"id":"56847658385cd98e","type":"group","z":"e51c499288aa059c","name":"visualise markdown content in info box","style":{"label":true},"nodes":["d07aa0c3b830ccf1","06a42fdc032c539f","605bc2ca67a50994","9df58b6177897325","3242ad96df5ac7da","2fdea2c5ae31eb21","53ea3eec68329f5d"],"x":85,"y":1514,"w":543,"h":244},{"id":"e037ab5e078ec3ec","type":"group","z":"e51c499288aa059c","name":"Ensure subfows are transported \\n with flow even if not used","style":{"label":true},"nodes":["5bfe45a52b14a360","cf82ba4ccf726c96","4a7307396a3313f0","df8bfcedeae84991","395f35d864246444","2cc58903ff784d1b"],"x":86,"y":2056,"w":292,"h":531},{"id":"2822351c6b8f8bdd","type":"junction","z":"e51c499288aa059c","x":2729.1223603487015,"y":1328.8978873491287,"wires":[["afb3d0f568acb3ae","a62841ebc7ac90c3"]]},{"id":"d44eab2102a8a799","type":"junction","z":"e51c499288aa059c","x":2993.4693896770477,"y":1090.7347149848938,"wires":[["902fdd9cd18f05d8","27aa1a5e47d8ed90"]]},{"id":"4d3e42de08e63b9d","type":"junction","z":"e51c499288aa059c","x":2974.142847061157,"y":973.2857135534286,"wires":[["5507b6d18c9ce484","fa7431a2d8a755c6"]]},{"id":"e26a30ff2809e98b","type":"ui_template","z":"e51c499288aa059c","g":"6c956af2b71922a1","group":"97885fc627878fef","name":"show question","order":9,"width":12,"height":7,"format":"","storeOutMessages":true,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","className":"","x":658.1666870117188,"y":1824.5001831054688,"wires":[["99db60304c670cc9"]]},{"id":"0d73bc93ea491552","type":"template","z":"e51c499288aa059c","g":"6c956af2b71922a1","name":"","field":"template","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<div style=\"font-size: 130%; font-weight: bold; margin-bottom: 30px; display: flex; justify-content: center;\">\n<span>{{{ question}}}</span>\n</div>\n\n{{#choices}}\n{{#text}}\n<md-button ng-click=\"send({ payload:'{{value}}', __linkSource: '{{__linkSource}}', _choices: '{{ _choices }}' })\">\n    {{text}}\n</md-button>\n{{/text}}\n{{/choices}}","output":"str","x":481.50018310546875,"y":1824.5001831054688,"wires":[["e26a30ff2809e98b"]]},{"id":"42fa137c805ffa57","type":"link in","z":"e51c499288aa059c","g":"6c956af2b71922a1","name":"decision tree ui","links":[],"x":124.50003051757812,"y":1884.5000762939453,"wires":[["03a875dc9fc37e55"]]},{"id":"021a75e9de1c8f9c","type":"link out","z":"e51c499288aa059c","g":"6c956af2b71922a1","name":"link out 124","mode":"return","links":[],"x":1024.83349609375,"y":1884.5000762939453,"wires":[]},{"id":"03a875dc9fc37e55","type":"function","z":"e51c499288aa059c","g":"6c956af2b71922a1","name":"prepare copy of link source \\n and htmlify the question","func":"msg.__linkSource = JSON.stringify(msg._linkSource)\n\nmsg.question = msg.question.replaceAll(\"\\\\n\",\"<br>\")\n\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":297.16668701171875,"y":1971.3333740234375,"wires":[["0d73bc93ea491552"]]},{"id":"99db60304c670cc9","type":"function","z":"e51c499288aa059c","g":"6c956af2b71922a1","name":"prepare the link source to \\n return to the original link call node","func":"if (msg.__linkSource && msg.payload ) {\n    msg._linkSource = JSON.parse(msg.__linkSource)\n}\n\nif (msg._linkSource) { return msg }\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":851.1666870117188,"y":1971.3333740234375,"wires":[["021a75e9de1c8f9c"]]},{"id":"51621964393c5d99","type":"ui_button","z":"e51c499288aa059c","name":"","group":"97885fc627878fef","order":2,"width":8,"height":2,"passthru":false,"label":"start / restart","tooltip":"","color":"orange","bgcolor":"rgb(221, 246, 206)","className":"","icon":"","payload":"","payloadType":"date","topic":"topic","topicType":"msg","x":277,"y":567,"wires":[["83537c84badd2f0e","d38b15bd49a920cd","8f7ecd3035532ac3"]]},{"id":"59e70b48e3ac5385","type":"change","z":"e51c499288aa059c","name":"","rules":[{"t":"set","p":"enabled","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":386,"y":438,"wires":[["51621964393c5d99"]]},{"id":"83537c84badd2f0e","type":"delay","z":"e51c499288aa059c","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":502,"y":567,"wires":[["59e70b48e3ac5385"]]},{"id":"cfcd2e897d5c0486","type":"link in","z":"e51c499288aa059c","name":"input to start button","links":[],"x":120,"y":635,"wires":[["51621964393c5d99","5bc239bb80c26247"]]},{"id":"5bc239bb80c26247","type":"link out","z":"e51c499288aa059c","name":"link out 125","mode":"return","links":[],"x":208,"y":697,"wires":[]},{"id":"45671ba13d950f7c","type":"inject","z":"e51c499288aa059c","name":"enable button","props":[{"p":"enabled","v":"true","vt":"bool"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":163,"y":753,"wires":[["51621964393c5d99"]]},{"id":"d38b15bd49a920cd","type":"subflow:08e99cbd5f4d9de5","z":"e51c499288aa059c","name":"Is Node-RED missing functionality?","env":[{"name":"question","value":"Is Node-RED missing functionality?","type":"str"}],"x":553,"y":1278,"wires":[["7edee354c4d71a9f","0b0bf400cc4c2393"],["c29f1df3a6b3dce5"]]},{"id":"c29f1df3a6b3dce5","type":"subflow:104818a352e4dbd7","z":"e51c499288aa059c","name":"OK, then you are done!","env":[{"name":"result","value":"OK, then you are done!","type":"str"}],"x":838,"y":1300,"wires":[]},{"id":"7edee354c4d71a9f","type":"subflow:08e99cbd5f4d9de5","z":"e51c499288aa059c","name":"Have you checked flows.nodered.org?","env":[{"name":"question","value":"Have you checked flows.nodered.org?","type":"str"}],"x":883,"y":1225,"wires":[["25a4bbef9d4e1182","6073cf5b5f914691"],["05769ebd154bdb43"]]},{"id":"d07aa0c3b830ccf1","type":"ui_template","z":"e51c499288aa059c","g":"56847658385cd98e","group":"97885fc627878fef","name":"show info","order":6,"width":12,"height":8,"format":"<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":354,"y":1670,"wires":[[]]},{"id":"05769ebd154bdb43","type":"subflow:104818a352e4dbd7","z":"e51c499288aa059c","name":"Ok, check flows.nodered.org first","env":[{"name":"result","value":"Ok, check flows.nodered.org first","type":"str"}],"x":1202,"y":1300,"wires":[]},{"id":"06a42fdc032c539f","type":"change","z":"e51c499288aa059c","g":"56847658385cd98e","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":342,"y":1712,"wires":[["d07aa0c3b830ccf1"]]},{"id":"605bc2ca67a50994","type":"link in","z":"e51c499288aa059c","g":"56847658385cd98e","name":"reset info block","links":["0536aa265d220f9e","a1765e0cd70424e5","b15d13f6fdfef491"],"x":126,"y":1717,"wires":[["06a42fdc032c539f"]]},{"id":"9df58b6177897325","type":"function","z":"e51c499288aa059c","g":"56847658385cd98e","name":"MD -> HTML w/ note container","func":"if (msg.payload === undefined || typeof msg.payload !== \"string\") {\n    throw \"Markdown Content Not Found\";\n} \n\nvar md = markdownIt({ \n    html: true, \n    linkify: true, \n    typographer: true,\n    breaks: true,\n    xhtmlOut: false,\n    highlight: function(str, lang) {\n        if ( lang == \"mermaid\") {\n            return '<pre class=\"mermaid-pre-container\"><code class=\"mermaid\">\\n' + md.utils.escapeHtml(str) + '\\n</code></pre>';\n        }\n\n        // this is for javascript and co.\n        if (lang && highlightJs.getLanguage(lang)) {\n            try {\n                return '<pre class=\"hljs\"><code class=\"language-'+ lang + ' hljs\">' +\n                    highlightJs.highlight(str, { language: lang, ignoreIllegals: true }).value +\n                    '</code></pre>';\n            } catch (__) { }\n        }\n\n        // this is for noderedjson-XXXXX\n        return '<pre class=\"language-'+lang+' hljs\"><code class=\"language-'+lang+' hljs\">' + md.utils.escapeHtml(str) + '</code></pre>';\n    }\n});\n\nmd.use(markdownItFootnote);\nmd.use(markdownItMark);\nmd.use(markdownItSup);\nmd.use(markdownItLinkAttributes, {\n    attrs: {\n        target: \"_blank\",\n        rel: \"noopener\",\n    },\n});\n\nmsg.payload = md.render(msg.payload);\n\nreturn msg;\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[{"var":"markdownIt","module":"markdown-it"},{"var":"markdownItContainer","module":"markdown-it-container"},{"var":"markdownItFootnote","module":"markdown-it-footnote"},{"var":"markdownItMark","module":"markdown-it-mark"},{"var":"highlightJs","module":"highlight.js"},{"var":"markdownItLinkAttributes","module":"markdown-it-link-attributes"},{"var":"markdownItSup","module":"markdown-it-sup"}],"x":472,"y":1621,"wires":[["d07aa0c3b830ccf1"]],"icon":"node-red-node-markdown/parser-markdown.png"},{"id":"25a4bbef9d4e1182","type":"subflow:08e99cbd5f4d9de5","z":"e51c499288aa059c","name":"Have you asked on the Node-RED forum?","env":[{"name":"question","value":"Have you asked on the Node-RED forum?","type":"str"}],"x":1270,"y":1192,"wires":[["10fddea0fd8b7aa1","a2b71f24ef85503b"],["78ffc5b43d407b3e"]]},{"id":"78ffc5b43d407b3e","type":"subflow:104818a352e4dbd7","z":"e51c499288aa059c","name":"Ok, ask the forum for help.","env":[{"name":"result","value":"Ok, ask the forum for help.","type":"str"}],"x":1618,"y":1300,"wires":[]},{"id":"e84cbae4e95dcdf3","type":"link out","z":"e51c499288aa059c","name":"link out 129","mode":"link","links":["a7d81acd47232659","3242ad96df5ac7da"],"x":1383,"y":1155.5,"wires":[]},{"id":"e8111ed9553ecdf9","type":"link out","z":"e51c499288aa059c","name":"link out 130","mode":"link","links":["3242ad96df5ac7da"],"x":978,"y":1185,"wires":[]},{"id":"3242ad96df5ac7da","type":"link in","z":"e51c499288aa059c","g":"56847658385cd98e","name":"show md content","links":["e8111ed9553ecdf9","e84cbae4e95dcdf3","0bc14bd8a852dfa4","4149e843d7e7c18f","0272ec429d75b936","f865415e5ecd2fd0","9f4321011394b44d","3435a30902c36512","6c05c31e5e47397c","80d499d2066c0424"],"x":127,"y":1676,"wires":[["2fdea2c5ae31eb21"]]},{"id":"10fddea0fd8b7aa1","type":"subflow:08e99cbd5f4d9de5","z":"e51c499288aa059c","name":"Is there an existing NPMjs.com package?","env":[{"name":"question","value":"Is there an existing NPMjs.com package?","type":"str"}],"x":1650,"y":1086,"wires":[["fa1412682d1ac9be","5df3aba1cac4730c"],["8fbe733aacf19d32","31f65e37f1fe92d6"]]},{"id":"0bc14bd8a852dfa4","type":"link out","z":"e51c499288aa059c","name":"link out 131","mode":"link","links":["a7d81acd47232659","3242ad96df5ac7da"],"x":1677,"y":1142.5,"wires":[]},{"id":"8fbe733aacf19d32","type":"subflow:08e99cbd5f4d9de5","z":"e51c499288aa059c","name":"Do you understand Javascript?","env":[{"name":"question","value":"Do you understand Javascript?","type":"str"}],"x":2016,"y":1130,"wires":[["2822351c6b8f8bdd"],["2822351c6b8f8bdd"]]},{"id":"4149e843d7e7c18f","type":"link out","z":"e51c499288aa059c","name":"link out 133","mode":"link","links":["a7d81acd47232659","3242ad96df5ac7da"],"x":2077,"y":1166,"wires":[]},{"id":"fa1412682d1ac9be","type":"subflow:08e99cbd5f4d9de5","z":"e51c499288aa059c","name":"Do you understand Javascript?","env":[{"name":"question","value":"Do you understand Javascript?","type":"str"}],"x":2013,"y":1031,"wires":[["854c8c5f070a70f1","ef9faeb7ffc7668e"],["042027b847036a0c"]]},{"id":"0272ec429d75b936","type":"link out","z":"e51c499288aa059c","name":"link out 134","mode":"link","links":["a7d81acd47232659","3242ad96df5ac7da"],"x":2069,"y":1069,"wires":[]},{"id":"5bfe45a52b14a360","type":"subflow:6cf8708f9a09860e","z":"e51c499288aa059c","g":"e037ab5e078ec3ec","name":"","x":212,"y":2128,"wires":[[],[],[],[]]},{"id":"cf82ba4ccf726c96","type":"subflow:af587bc01058b6fd","z":"e51c499288aa059c","g":"e037ab5e078ec3ec","name":"","x":212,"y":2241.6,"wires":[[],[],[],[],[],[]]},{"id":"4a7307396a3313f0","type":"subflow:a834ee234dd774a1","z":"e51c499288aa059c","g":"e037ab5e078ec3ec","name":"","x":212,"y":2340.2,"wires":[[],[]]},{"id":"df8bfcedeae84991","type":"subflow:74e1d54a72b1f8cd","z":"e51c499288aa059c","g":"e037ab5e078ec3ec","name":"","x":202,"y":2408.7999999999997,"wires":[[]]},{"id":"395f35d864246444","type":"subflow:104818a352e4dbd7","z":"e51c499288aa059c","g":"e037ab5e078ec3ec","name":"","x":232,"y":2477.3999999999996,"wires":[]},{"id":"2cc58903ff784d1b","type":"subflow:08e99cbd5f4d9de5","z":"e51c499288aa059c","g":"e037ab5e078ec3ec","name":"","x":212,"y":2546,"wires":[[],[]]},{"id":"854c8c5f070a70f1","type":"subflow:08e99cbd5f4d9de5","z":"e51c499288aa059c","name":"Is the existing package an ESM package?","env":[{"name":"question","value":"Is the existing package an ESM package?","type":"str"}],"x":2330,"y":970,"wires":[["4d3e42de08e63b9d"],["69be31496d52b8fd","b15d13f6fdfef491"]]},{"id":"f865415e5ecd2fd0","type":"link out","z":"e51c499288aa059c","name":"link out 135","mode":"link","links":["a7d81acd47232659","3242ad96df5ac7da"],"x":2373,"y":926,"wires":[]},{"id":"5507b6d18c9ce484","type":"subflow:104818a352e4dbd7","z":"e51c499288aa059c","name":"Then you will need to create a custom node.","env":[{"name":"result","value":"Then you will need to create a custom node.","type":"str"}],"x":3196,"y":923,"wires":[]},{"id":"9f4321011394b44d","type":"link out","z":"e51c499288aa059c","name":"link out 136","mode":"link","links":["a7d81acd47232659","3242ad96df5ac7da"],"x":3278,"y":880,"wires":[]},{"id":"afb3d0f568acb3ae","type":"subflow:104818a352e4dbd7","z":"e51c499288aa059c","name":"Questionaire is not yet Completed.","env":[{"name":"result","value":"Questionaire is not yet Completed.","type":"str"}],"x":2909,"y":1355,"wires":[]},{"id":"3435a30902c36512","type":"link out","z":"e51c499288aa059c","name":"link out 137","mode":"link","links":["a7d81acd47232659","3242ad96df5ac7da"],"x":2996,"y":1306,"wires":[]},{"id":"042027b847036a0c","type":"link out","z":"e51c499288aa059c","name":"link out 138","mode":"link","links":["69067d7fe488f806"],"x":2219,"y":1038,"wires":[]},{"id":"69067d7fe488f806","type":"link in","z":"e51c499288aa059c","name":"link in 1","links":["042027b847036a0c"],"x":1029,"y":1038.5,"wires":[["78ffc5b43d407b3e","6073cf5b5f914691"]]},{"id":"27aa1a5e47d8ed90","type":"subflow:104818a352e4dbd7","z":"e51c499288aa059c","name":"You can try to test the package using a function node.","env":[{"name":"result","value":"You can try to test the package using a function node.","type":"str"}],"x":3233,"y":1119,"wires":[]},{"id":"6c05c31e5e47397c","type":"link out","z":"e51c499288aa059c","name":"link out 139","mode":"link","links":["a7d81acd47232659","3242ad96df5ac7da"],"x":3299,"y":1070,"wires":[]},{"id":"902fdd9cd18f05d8","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"create a function node","format":"markdown","syntax":"mustache","template":"## Custom function node\n\nWriting [function nodes](https://nodered.org/docs/user-guide/writing-functions) is also well documented and function nodes allow packages to be included:\n\n![img](https://cdn.openmindmap.org/content/1701083252313_Screen_Shot_2023-11-27_at_12.07.29.png)\n\nIn the `Setup` tab of the function node modules can be defined that are automatically included in the function node. Packages are automatically installed by Node-RED using their `latest` version.\n\nIf you require a specific version, then you will need to create a [custom node](https://nodered.org/docs/creating-nodes/).","output":"str","x":3137,"y":1071,"wires":[["6c05c31e5e47397c"]]},{"id":"2fdea2c5ae31eb21","type":"switch","z":"e51c499288aa059c","g":"56847658385cd98e","name":"","property":"contents","propertyType":"msg","rules":[{"t":"nnull"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":188,"y":1615,"wires":[["53ea3eec68329f5d"],["9df58b6177897325"]]},{"id":"53ea3eec68329f5d","type":"change","z":"e51c499288aa059c","g":"56847658385cd98e","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"contents[0].contents","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":289,"y":1555,"wires":[["9df58b6177897325"]]},{"id":"fa7431a2d8a755c6","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"creating custom nodes","format":"markdown","syntax":"mustache","template":"## Custom Nodes\n\nCreating custom nodes in Node-RED is [well documented](https://nodered.org/docs/creating-nodes/).\n\nESM packages are supported using function nodes *but* only if those ESM packages [provide a \"default\"](https://discourse.nodered.org/t/best-practice-custom-v-function-node/83222/16).\n\nWriting [function nodes](https://nodered.org/docs/user-guide/writing-functions) is also well documented and it might be worth a try with a function node first before building a custom node.\n\nCustom nodes allow for the specification of dependencies and their exact version via a [package.json](https://nodered.org/docs/creating-nodes/packaging#packagejson) file.\n\n### User Interface\n\nNode-RED also provides a number of UI [widgets](https://nodered.org/docs/api/ui/) for providing a unified UI across all nodes.","output":"str","x":3129,"y":880,"wires":[["9f4321011394b44d"]]},{"id":"69be31496d52b8fd","type":"subflow:08e99cbd5f4d9de5","z":"e51c499288aa059c","name":"Do you wish to use a specific version of the package?","env":[{"name":"question","value":"Do you wish to use a specific version of the package?","type":"str"}],"x":2700,"y":1037,"wires":[["4d3e42de08e63b9d"],["d44eab2102a8a799"]]},{"id":"b15d13f6fdfef491","type":"link out","z":"e51c499288aa059c","name":"link out 140","mode":"link","links":["605bc2ca67a50994","f5234b7d5afb80b8"],"x":2567,"y":994,"wires":[]},{"id":"ef9faeb7ffc7668e","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"ESM Package","format":"markdown","syntax":"mustache","template":"## ESM v. CJS Packages\n\n[ECMAScript modules](https://nodejs.org/api/esm.html#modules-ecmascript-modules) (ESM) are the official standard format to package JavaScript code for reuse. Modules are defined using a variety of import and export statements.\n\n[CommonJS modules](https://nodejs.org/api/modules.html#modules-commonjs-modules) (CJS) are the original way to package JavaScript code for Node.js. Node.js also supports the ECMAScript modules standard used by browsers and other JavaScript runtimes.\n\nESM Packages are only partially supported in Node-RED.\n","output":"str","x":2247,"y":926,"wires":[["f865415e5ecd2fd0"]]},{"id":"a62841ebc7ac90c3","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"QED","format":"markdown","syntax":"mustache","template":"## Sorry this questionaire is not complete\n\nCompletion of this questionaire is pending!\n\n","output":"str","x":2824,"y":1306,"wires":[["3435a30902c36512"]]},{"id":"31f65e37f1fe92d6","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"js & nodejs","format":"markdown","syntax":"mustache","template":"## Javascript & NodeJS\n\nNode-RED has been created in NodeJS which is a server side version of Javascript. Existing Javascript code can be easily integrated into Node-RED using the *function node*.\n\n","output":"str","x":1954,"y":1166,"wires":[["4149e843d7e7c18f"]]},{"id":"5df3aba1cac4730c","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"js & nodejs","format":"markdown","syntax":"mustache","template":"## Javascript & NodeJS\n\nNode-RED has been created in NodeJS which is a server side version of Javascript. Existing Javascript code can be easily integrated into Node-RED using the *function node*.\n\nEven though Node-RED is largely low-code, an awareness of Javascript is of benefit. Much can be done with Node-RED with a basic understanding of Javascript","output":"str","x":1960,"y":1069,"wires":[["0272ec429d75b936"]]},{"id":"0b0bf400cc4c2393","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"flows.nodered.org ","format":"markdown","syntax":"mustache","template":"## Existing extensions\n\n[Flows.nodered.org](https://flows.nodered.org) has a collection of nodes, flows and collections.\n\nMuch has already been done, perhaps there is a solution that will solve your requirements.\n\n### Nodes\n\nFor specific interfaces to devices, checkout the [nodes collection](https://flows.nodered.org/search?type=node). \n\n### Flows\n\nFor more doing specific tasks using Node-RED, perhaps there already exists a [flow](https://flows.nodered.org/search?type=flow).\n\n### Collections\n\nFinally there are collections of Node-RED resources around a specific topic. For example, for [interacting with Home Assistant](https://flows.nodered.org/collection/0R7Vjr77K6fS).\n\n### Cookbooks\n\nThere are also some [howtos](https://cookbook.nodered.org/) in the cookbook.\n\n","output":"str","x":804,"y":1185,"wires":[["e8111ed9553ecdf9"]]},{"id":"6073cf5b5f914691","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"node-red forum","format":"markdown","syntax":"mustache","template":"## Node-RED Forum\n\nThe Node-RED [forum](https://discourse.nodered.org/) is open to all and every level of experience with Node-RED.\n\nIf you are unsure where to ask, start at the [general](https://discourse.nodered.org/c/general/7) category.\n\nPoliteness is always good!\n\n","output":"str","x":1194,"y":1155,"wires":[["e84cbae4e95dcdf3"]]},{"id":"a2b71f24ef85503b","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"npmjs.com","format":"markdown","syntax":"mustache","template":"## npmjs.com\n\n[NPMjs](https://npmjs.com) is the package manager for Javascript and there are many thousands of packages that can easily be integrated into Node-RED.\n\n","output":"str","x":1560,"y":1142.5,"wires":[["0bc14bd8a852dfa4"]]},{"id":"ea4b878f64088275","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"","format":"markdown","syntax":"mustache","template":"","output":"str","x":1730,"y":716,"wires":[[]]},{"id":"80d499d2066c0424","type":"link out","z":"e51c499288aa059c","name":"link out 141","mode":"link","links":["3242ad96df5ac7da"],"x":610,"y":1238,"wires":[]},{"id":"8f7ecd3035532ac3","type":"PkgFile","z":"e51c499288aa059c","name":"","filename":"Node-RED","format":"markdown","syntax":"mustache","template":"## Node-RED\n\n> Low-code programming for event-driven applications\n\n[Node-RED](https://nodered.org) is a programming tool for wiring together hardware devices, APIs and online services in new and interesting ways.\n\nIt provides a browser-based editor that makes it easy to wire together flows using the wide range of nodes in the palette that can be deployed to its runtime in a single-click.\n\nNode-RED is extreme extendable in many ways. It depends on what you wish to do, to know what the right extension is. This questionaire will help you do decide between the following possible extensions:\n\n- [Flows](https://nodered.org/docs/developing-flows/flow-structure) are the fundamental extensions to Node-RED, they are the basis for everything. \n- [Subflows](https://nodered.org/docs/user-guide/editor/workspace/subflows) are repetitive actions that can be included into multiple flows providing the same functionality.\n- [Function nodes](https://nodered.org/docs/user-guide/writing-functions) provide Javascript extensibility including using third-party NPM packages.\n- [Custom nodes](https://nodered.org/docs/creating-nodes/) are custom Javascript code that can be [distributed](https://flows.nodered.org/) to other users of Node-RED.","output":"str","x":488,"y":1238,"wires":[["80d499d2066c0424"]]},{"id":"0915256aa7d217dd","type":"ui_spacer","z":"e51c499288aa059c","name":"spacer","group":"97885fc627878fef","order":1,"width":2,"height":1},{"id":"8ac578cb5ad72c3f","type":"ui_spacer","z":"e51c499288aa059c","name":"spacer","group":"97885fc627878fef","order":3,"width":2,"height":1},{"id":"c14c2d6e671337e7","type":"ui_spacer","z":"e51c499288aa059c","name":"spacer","group":"97885fc627878fef","order":4,"width":2,"height":1},{"id":"70d60f3fda78a6c7","type":"ui_spacer","z":"e51c499288aa059c","name":"spacer","group":"97885fc627878fef","order":5,"width":2,"height":1},{"id":"940b12a3f6041cd0","type":"ui_spacer","z":"e51c499288aa059c","name":"spacer","group":"97885fc627878fef","order":7,"width":12,"height":1},{"id":"6ade80eb012e381a","type":"ui_spacer","z":"e51c499288aa059c","name":"spacer","group":"97885fc627878fef","order":8,"width":12,"height":1},{"id":"97885fc627878fef","type":"ui_group","name":"Extension Selection","tab":"7260db544c0af12f","order":1,"disp":true,"width":"12","collapse":false,"className":""},{"id":"7260db544c0af12f","type":"ui_tab","name":"Extension Selection","icon":"dashboard","disabled":false,"hidden":false}]