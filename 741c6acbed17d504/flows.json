[{"id":"741c6acbed17d504","type":"tab","label":"[experimental] Node-RED Community catalogue","disabled":false,"info":"### Description\n\nA basic analyses of the Node-RED Community catalogue.\n\nTakes the catalogue details and tries to make nice looking graphs from it.\n\n![img](https://cdn.openmindmap.org/content/1698262081584_Screen_Shot_2023-10-25_at_21.27.57.png)\n\n![img](https://cdn.openmindmap.org/content/1698262103086_Screen_Shot_2023-10-25_at_21.28.19.png)\n\n![img](https://cdn.openmindmap.org/content/1698262124007_Screen_Shot_2023-10-25_at_21.28.40.png)\n\n","env":[]},{"id":"50d3daf2d40242cd","type":"group","z":"741c6acbed17d504","name":"download numbers","style":{"label":true},"nodes":["5ab1307cde32f1fb","f84248691ed06d3d","81183f4703a06f49","8f2128989276a991","67200a1f56d67d09","64f65485e85f9ba7","3e5c72bc75ddc5b7","ab60574324c52a44","d8bf6929c3458b1d","0d5024c37044c70a","56d2378be86a91d3","df18d1223b13f05a","8250415e5f2c89cd","3e34e30ee81ea525","7795563e2648cb7a","200dd7b329a4191e","5a18cef8307f4179","e381d4b2527eb33b"],"x":198.75,"y":2243.333251953125,"w":1572.5,"h":433.666748046875},{"id":"9b48b443f84a0653","type":"group","z":"741c6acbed17d504","name":"how many downloads are defined?","style":{"label":true},"nodes":["359d48a6b99d46c9","2d9d68e96c33a00b","e5dee8ee63cc44c3","e927cfffadbcf09a"],"x":1004.25,"y":2698.833251953125,"w":767,"h":82},{"id":"f98a6a1875c36277","type":"group","z":"741c6acbed17d504","name":"retrieve version details","style":{"label":true},"nodes":["cb7aa51cff5e5580","0280b91f32c74573","ce3e7eaaf9f9ac2d","f4847a5dba23f723","c0740d5553947cfd","8045064c5212858b","525ff4bef34b3a66","431906ed74e84938","8b993b2ec9fecad0","042c5cb781781ffe","a0af637a6816c6e7","8f7f852a46655a05","ad21b0ba9c731507","3d4e76c8dc54e012","edde60f0b0917325","0f31a57b165af276","b4baba4cbfaebef8","6f70a024e1b52425"],"x":223.75,"y":2843.5,"w":1547.5,"h":422.5},{"id":"8ca7d5fd124078bb","type":"group","z":"741c6acbed17d504","name":"how many versions are defined?","style":{"label":true},"nodes":["1e4ca5108278c8bd","ddd4da103f23a14f","8850a08e7b35d028","cd6ca105174a79b8"],"x":1004.25,"y":3293.5,"w":767,"h":82},{"id":"206d219714878a64","type":"http request","z":"741c6acbed17d504","name":"","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://catalogue.nodered.org/catalogue.json?_={{ payload }}","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":510.6666564941406,"y":1480.6111698150635,"wires":[["f544e75095b4b089","a9e223ba3da5fd6c","d4a8db88a2d62d2b","142f96b4a47de0ec","e51fbfae8f6f88d4","e6d53528d2196e15","fb5a017272acb096","9792fe31e9eb49ec","ca3f486d4be3fb14","2f0167db58f7ce54","27e9cacefbc9e0e0","50b0c642f7829303","67659a26f732abce","25bc3304e70968ae"]]},{"id":"db7468f93f6d28c4","type":"inject","z":"741c6acbed17d504","name":"Generate initial data","props":[],"repeat":"","crontab":"","once":true,"onceDelay":"1","topic":"","x":222.77776336669922,"y":1480.6111698150635,"wires":[["206d219714878a64"]]},{"id":"f544e75095b4b089","type":"debug","z":"741c6acbed17d504","name":"debug 48","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":497.6666564941406,"y":1593.333378791809,"wires":[]},{"id":"dec7a25e92772aec","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":3,"width":12,"height":20,"label":"top keywords, used by at least 10 modules","chartType":"bar","legend":"true","xformat":"auto","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1937.000129699707,"y":902.5,"wires":[[]]},{"id":"a9e223ba3da5fd6c","type":"function","z":"741c6acbed17d504","name":"top keywords","func":"var keywords = {};\nmsg.payload.modules.forEach(function(module) {\n    (module.keywords || []).forEach(function(keyword) {\n        keyword = keyword.toLowerCase()\n        keywords[keyword] ||= 0\n        keywords[keyword] += 1\n    });\n});\n\n\ndelete keywords[\"node-red\"]\ndelete keywords[\"node-red-contrib\"]\ndelete keywords[\"node-red-contrib-contribgen\"]\n// delete keywords[\"iot\"]\ndelete keywords[\"node\"]\ndelete keywords[\"nodered\"]\n\nvar keys = Object.keys(keywords);\nvar kvs = keys.map((k) => { return [k, keywords[k]]})\nkvs = kvs.sort( (a,b) => { return a[1] < b[1] ? 1 : -1 })\n\nmsg.payload = [{\n    \"series\": kvs.filter( (v) => { return v[1] > 9 }).map((v) => { return v[0]}),\n    \"data\": kvs.filter((v) => { return v[1] > 9 }).map((v) => { return [v[1]] }),\n    \"labels\": [\"Keywords\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":902.5,"wires":[["dec7a25e92772aec"]]},{"id":"d4a8db88a2d62d2b","type":"function","z":"741c6acbed17d504","name":"updates per day","func":"var lastestUpdates = {};\nmsg.payload.modules.forEach(function(module) {\n    module.updated_at = module.updated_at.split(\"T\")[0]\n\n    lastestUpdates[module.updated_at] ||= 0\n    lastestUpdates[module.updated_at] += 1\n});\n\nvar keys = Object.keys(lastestUpdates);\nvar kvs = keys.map((k) => { return [k, lastestUpdates[k]]})\nkvs = kvs.sort( (a,b) => { return Date.parse(a[0]) < Date.parse(b[0]) ? 1 : -1 })\n\nkvs.length = 2000\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0]}),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Days\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":983.5,"wires":[["bdcf58f8b5f0a53f"]]},{"id":"bdcf58f8b5f0a53f","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":4,"width":12,"height":20,"label":"updates per day, last 2000 days","chartType":"bar","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1897.000129699707,"y":983.5,"wires":[[]]},{"id":"142f96b4a47de0ec","type":"function","z":"741c6acbed17d504","name":"top version numbers","func":"var topVersionNunbers = {};\n\nmsg.payload.modules.forEach(function(module) {\n    topVersionNunbers[module.version] ||= 0\n    topVersionNunbers[module.version] += 1\n});\n\nvar keys = Object.keys(topVersionNunbers);\nvar kvs = keys.map((k) => { return [k, topVersionNunbers[k]]})\nkvs = kvs.sort( (a,b) => { return a[1] < b[1] ? 1 : -1 })\n\nkvs.length = 100\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0]}),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Versions\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":1083,"wires":[["da734d225bc3a03b"]]},{"id":"da734d225bc3a03b","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":5,"width":12,"height":20,"label":"top 100 version numbers","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1877.000129699707,"y":1083,"wires":[[]]},{"id":"e51fbfae8f6f88d4","type":"function","z":"741c6acbed17d504","name":"last 100 updates","func":"var latestPackageUpdates = [];\n\nmsg.payload.modules.forEach(function(module) {\n    latestPackageUpdates.push([\n        module.id,\n        module.updated_at.split(\"T\")[0],\n        module.description,\n        module.version,\n        module.keywords\n    ])\n});\n\nkvs = latestPackageUpdates.sort( (a,b) => { return Date.parse(a[1]) <= Date.parse(b[1]) ? 1 : -1 })\n\nkvs.length = 100\n\nmsg.payload = kvs.map((v) => {\n    return {\n        \"value\": v[0],\n        \"date\": v[1],\n        \"desc\": v[2],\n        \"version\": v[3],\n        \"tags\": (v[4] || []).map(d => { return { tag: d } })\n    }\n})\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":1200,"wires":[["d34e2aac0af1c3b4"]]},{"id":"696d4b7a9edc9456","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"List of latest updated packages","order":13,"width":12,"height":15,"format":"<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1897.000129699707,"y":1200,"wires":[[]]},{"id":"d34e2aac0af1c3b4","type":"template","z":"741c6acbed17d504","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<dl>\n{{#payload}}\n  <dt><b><a target=\"_blank\" href=\"https://flows.nodered.org/search?term={{ value }}\">{{ value}}</a></b> ({{date}})</dt>\n  <dd><i>{{ version }}</i> {{#tags}}{{tag}},{{/tags}}<br>\n  <i>{{ desc }}</i>\n  </dd>\n{{/payload}}\n</dl>\n","output":"str","x":1284,"y":1200,"wires":[["696d4b7a9edc9456"]]},{"id":"476d44ecaa16b0f0","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"TItle","order":12,"width":12,"height":1,"format":"<h2>Last 100 package Updates</h2>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1817.000129699707,"y":1154,"wires":[[]]},{"id":"e6d53528d2196e15","type":"function","z":"741c6acbed17d504","name":"top major version number","func":"var topVersionNunbers = {};\n\nmsg.payload.modules.forEach(function(module) {\n    topVersionNunbers[module.version.split(\".\")[0]] ||= 0\n    topVersionNunbers[module.version.split(\".\")[0]] += 1\n});\n\nvar keys = Object.keys(topVersionNunbers);\nvar kvs = keys.map((k) => { return [k, topVersionNunbers[k]]})\nkvs = kvs.sort( (a,b) => { return a[1] < b[1] ? 1 : -1 })\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0]}),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Major Version\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":950,"y":1281.5,"wires":[["cd46143e9a042d89"]]},{"id":"cd46143e9a042d89","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":6,"width":12,"height":20,"label":"top major version number (major.minor.patch)","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1947.000129699707,"y":1281.5,"wires":[[]]},{"id":"fb5a017272acb096","type":"function","z":"741c6acbed17d504","name":"highest defined types","func":"var typeCounts = {};\n\nmsg.payload.modules.forEach(function(module) {\n    typeCounts[module.types.length] ||= 0\n    typeCounts[module.types.length] += 1\n});\n\nvar keys = Object.keys(typeCounts);\nvar kvs = keys.map((k) => { return [k, typeCounts[k]]})\nkvs = kvs.sort( (a,b) => { return parseInt(a[0]) > parseInt(b[0]) ? 1 : -1 })\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0]}),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Type counts\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":1365.5,"wires":[["fc97bcdb069767a2"]]},{"id":"fc97bcdb069767a2","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":7,"width":12,"height":20,"label":"node types defined by package","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1897.000129699707,"y":1365.5,"wires":[[]]},{"id":"9792fe31e9eb49ec","type":"function","z":"741c6acbed17d504","name":"number of types > 20","func":"var topTypeCounts = [];\n\nmsg.payload.modules.forEach(function(module) {\n    topTypeCounts.push([\n        module.id,\n        module.types.length,\n        module.version,\n        module.description,\n        module.keywords\n    ])\n});\n\nvar kvs = topTypeCounts.filter((d) => { \n    return (parseInt(d[1]) > 19 || parseInt(d[1]) == 0 )\n}).sort( (a,b) => { \n    return parseInt(a[1]) <= parseInt(b[1]) ? 1 : -1 \n})\n\nmsg.payload = kvs.map((v) => {\n    return {\n        \"value\": v[0],\n        \"count\": parseInt(v[1]),\n        \"version\": v[2],\n        \"desc\": v[3],\n        \"tags\": (v[4]||[]).map( d => { return { tag: d }})\n    }\n})\n\nreturn [\n    {\n        ...msg,\n        payload: msg.payload.filter( d => { return d.count > 0 })\n    },\n    {\n        ...msg,\n        payload: msg.payload.filter(d => { return d.count == 0 })\n    }\n]","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":1479,"wires":[["fc1728e12900a63e"],["75ceb26047ef4853"]]},{"id":"26071b19cfe2addb","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"List of type counts","order":15,"width":12,"height":15,"format":"<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1857.000129699707,"y":1472,"wires":[[]]},{"id":"fc1728e12900a63e","type":"template","z":"741c6acbed17d504","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<dl>\n{{#payload}}\n  <dt><b><a target=\"_blank\" href=\"https://flows.nodered.org/search?term={{ value }}\">{{ value}}</a></b> ({{count}})</dt>\n  <dd><i>{{ version }}</i> {{#tags}}{{tag}},{{/tags}}<br><i>{{ desc }}</i></dd>\n{{/payload}}\n</dl>\n","output":"str","x":1284,"y":1472,"wires":[["26071b19cfe2addb"]]},{"id":"1cbcf2c1fb513439","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"TItle 2","order":14,"width":12,"height":1,"format":"<h2>Packages with the most types defined (above 20)</h2>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1817.000129699707,"y":1414,"wires":[[]]},{"id":"0de51abc98bd4b1f","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"List of packages with no node types defined","order":17,"width":12,"height":15,"format":"<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1937.000129699707,"y":1585.5,"wires":[[]]},{"id":"75ceb26047ef4853","type":"template","z":"741c6acbed17d504","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<dl>\n{{#payload}}\n  <dt><b><a target=\"_blank\" href=\"https://flows.nodered.org/search?term={{ value }}\">{{ value}}</a></b> ({{count}})</dt>\n  <dd><i>{{ version }}</i> {{#tags}}{{tag}},{{/tags}}<br><i>{{ desc }}</i></dd>\n{{/payload}}\n</dl>\n","output":"str","x":1284,"y":1585.5,"wires":[["0de51abc98bd4b1f"]]},{"id":"d52f1947d0f12e32","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"TItle 3","order":16,"width":12,"height":1,"format":"<h2>Packages with no node types defined</h2>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1817.000129699707,"y":1532,"wires":[[]]},{"id":"2ba7496fdee9fb94","type":"ui_button","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":1,"width":0,"height":0,"passthru":false,"label":"Refresh Data","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":273.77777099609375,"y":546.2222080230713,"wires":[["6e28a0aaf183ed8a","7a73184fb136e7db"]]},{"id":"ca3f486d4be3fb14","type":"function","z":"741c6acbed17d504","name":"top developers","func":"var topDevelopers = {};\n\nmsg.payload.modules.forEach(function(module) {\n    var devname = module.id.split(\"/\")\n    if ( devname.length > 1 ) {\n        topDevelopers[devname[0]] ||= 0\n        topDevelopers[devname[0]] += 1\n    }\n});\n\nvar keys = Object.keys(topDevelopers);\nvar kvs = keys.map((k) => { return [k, topDevelopers[k]]})\nkvs = kvs.sort( (a,b) => { return a[1] < b[1] ? 1 : -1 })\n\nkvs.length = 100;\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0]}),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Developers\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":1647,"wires":[["5353fbb10c120179"]]},{"id":"5353fbb10c120179","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":8,"width":12,"height":20,"label":"top 100 package prefixes","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1877.000129699707,"y":1647,"wires":[[]]},{"id":"e8c4690585fb2a41","type":"catch","z":"741c6acbed17d504","name":"","scope":null,"uncaught":false,"x":159,"y":1964,"wires":[["3fe48b832b51cf6b"]]},{"id":"3fe48b832b51cf6b","type":"debug","z":"741c6acbed17d504","name":"EXCEPTIONS WILL HAPPEN","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":421.1111259460449,"y":1962.8889141082764,"wires":[]},{"id":"6e28a0aaf183ed8a","type":"change","z":"741c6acbed17d504","name":"reset charts","rules":[{"t":"set","p":"payload","pt":"msg","to":"[]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1239,"y":546.2222080230713,"wires":[["dec7a25e92772aec","bdcf58f8b5f0a53f","da734d225bc3a03b","cd46143e9a042d89","fc97bcdb069767a2","696d4b7a9edc9456","26071b19cfe2addb","0de51abc98bd4b1f","5353fbb10c120179","08e9c9ce8d47bd36","c4d0f31a52436e6c","911d68596b80740e","c9f5e8734dc46760","c891cade66e07a2f","d3960b2b800f214f"]]},{"id":"7a73184fb136e7db","type":"delay","z":"741c6acbed17d504","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":437.1111602783203,"y":908.2222175598145,"wires":[["206d219714878a64"]]},{"id":"2f0167db58f7ce54","type":"function","z":"741c6acbed17d504","name":"top developers","func":"var prefixedPackages = 0;\nvar totalPackages = 0;\n\nmsg.payload.modules.forEach(function(module) {\n    var devname = module.id.split(\"/\")\n\n    totalPackages += 1\n    if ( devname.length > 1 ) {\n        prefixedPackages += 1\n    }\n});\n\nmsg.prefixedPackages = prefixedPackages;\nmsg.totalPackages = totalPackages;\nmsg.nonPrefixedPackages = totalPackages - prefixedPackages;\nmsg.lastUpdated = msg.payload.updated_at;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":829.5556030273438,"wires":[["46e5086ca7d0e5d1"]]},{"id":"08e9c9ce8d47bd36","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"Statistics","order":2,"width":12,"height":4,"format":"\n<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1827.000129699707,"y":829.5556030273438,"wires":[[]]},{"id":"46e5086ca7d0e5d1","type":"template","z":"741c6acbed17d504","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<h2>Packages</h2>\n\nTotal: <b>{{ totalPackages }}</b><br>\nPrefixed: <b>{{ prefixedPackages }}</b><br>\nNon-Prefixed: <b>{{ nonPrefixedPackages }}</b><br>\nLast updated at: <b>{{ lastUpdated }}</b><br>\n","output":"str","x":1284,"y":829.5556030273438,"wires":[["08e9c9ce8d47bd36"]]},{"id":"27e9cacefbc9e0e0","type":"function","z":"741c6acbed17d504","name":"last updates by year","func":"var groupByDate = {};\n\nmsg.payload.modules.forEach(function(module) {\n    var day = module.updated_at.split(\"T\")[0];\n\n    var month = day.split(\"-\").slice(0, 2).join(\"-\")\n    var year = day.split(\"-\").slice(0, 1).join(\"-\")\n\n    // groupByDate[month] = (groupByDate[month] || 0) + 1\n    groupByDate[year] = (groupByDate[year] || 0) + 1\n});\n\nvar keys = Object.keys(groupByDate);\nvar kvs = keys.map((k) => { return [k, groupByDate[k]] })\nkvs = kvs.sort((a, b) => { return parseInt(a[0]) < parseInt(b[1]) ? 1 : -1 })\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0] }),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Major Version\"]\n}]\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":1734.4445972442627,"wires":[["c4d0f31a52436e6c"]]},{"id":"c4d0f31a52436e6c","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":9,"width":12,"height":20,"label":"last update of packages by year","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1897.000129699707,"y":1734.4445972442627,"wires":[[]]},{"id":"50b0c642f7829303","type":"function","z":"741c6acbed17d504","name":"overlapping types","func":"var types = {};\n\nmsg.payload.modules.forEach( (module) => {\n    (module.types || []).forEach( (typ) => {\n        types[typ] = ( types[typ] || [] ).concat( [module.id] )\n    });\n});\n\n// occurs multiple times but seems to be ignored. Some packages\n// define this as a node type several times - some generational \n// error I assume.\ndelete types[\"__errors__\"]; \n\nvar kvs = Object.keys(types).map((k) => { return [k, types[k]]}).filter( (d) => {\n    return d[1].length > 1\n})\nkvs = kvs.sort( (a,b) => { return a[1].length < b[1].length ? 1 : -1 })\n\nvar orig = [...kvs]\n\nkvs.length = 100;\n\nreturn [\n    {\n        ...msg,\n        payload: [{\n            \"series\": kvs.map((v) => { return v[0] }),\n            \"data\": kvs.map((v) => { return [v[1].length] }),\n            \"labels\": [\"Types\"]\n        }]\n    },\n    {\n        ...msg,\n        payload: orig\n    }\n]","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":1813,"wires":[["911d68596b80740e"],["39a232c1f0d6f9cf"]]},{"id":"911d68596b80740e","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":10,"width":12,"height":20,"label":"top 100 overlapping types","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1877.000129699707,"y":1811,"wires":[[]]},{"id":"39a232c1f0d6f9cf","type":"debug","z":"741c6acbed17d504","name":"list of overlapping types","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1278.916618347168,"y":1877.6667861938477,"wires":[]},{"id":"5ab1307cde32f1fb","type":"http request","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://catalogue.nodered.org/catalogue.json?_={{ payload }}","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":896.25,"y":2479.583251953125,"wires":[["64f65485e85f9ba7"]]},{"id":"f84248691ed06d3d","type":"function","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"function 10","func":"msg.downloads = msg.downloads || {};\n\nvar module = msg.modules.pop();\n\nif ( module ) {\n    return [{\n            ...msg,\n            url: \"https://api.npmjs.org/downloads/point/last-week/\" + module.id,\n            module: module,\n            isempty: msg.downloads[module.id] == undefined\n        },\n        undefined\n    ]\n} else {\n    return [\n        undefined,\n        msg\n    ]\n}","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1492.25,"y":2393.083251953125,"wires":[["df18d1223b13f05a"],["7795563e2648cb7a"]]},{"id":"81183f4703a06f49","type":"http request","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"","method":"GET","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":true,"headers":[],"x":294.75,"y":2411.833251953125,"wires":[["3e5c72bc75ddc5b7"]]},{"id":"8f2128989276a991","type":"delay","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"","pauseType":"delay","timeout":"750","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":1355.75,"y":2503.833251953125,"wires":[["f84248691ed06d3d"]]},{"id":"67200a1f56d67d09","type":"debug","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"debug 49","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":1665.25,"y":2587.020751953125,"wires":[]},{"id":"64f65485e85f9ba7","type":"change","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"","rules":[{"t":"set","p":"downloads","pt":"msg","to":"downloads","tot":"flow","dc":true},{"t":"set","p":"modules","pt":"msg","to":"payload.modules","tot":"msg","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":1105.25,"y":2479.583251953125,"wires":[["f84248691ed06d3d"]]},{"id":"3e5c72bc75ddc5b7","type":"function","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"function 11","func":"msg.downloads = msg.downloads || {}\n\nif (msg.payload.package) {\n    msg.downloads[msg.payload.package] = msg.payload.downloads;\n    \n    return [\n        msg,\n        undefined\n    ]\n} else {\n    return [\n        undefined,\n        msg\n    ]\n}\n","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":397.25,"y":2595.020751953125,"wires":[["ab60574324c52a44"],["e381d4b2527eb33b"]]},{"id":"ab60574324c52a44","type":"change","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"","rules":[{"t":"set","p":"downloads","pt":"flow","to":"downloads","tot":"msg","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":1105.25,"y":2587.020751953125,"wires":[["67200a1f56d67d09","8f2128989276a991"]]},{"id":"d8bf6929c3458b1d","type":"inject","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"Trigger download number collection","props":[{"p":"payload"}],"repeat":"10800","crontab":"","once":false,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":617.25,"y":2479.583251953125,"wires":[["5ab1307cde32f1fb"]]},{"id":"0d5024c37044c70a","type":"catch","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"","scope":["81183f4703a06f49"],"uncaught":false,"x":415.25,"y":2393.833251953125,"wires":[["56d2378be86a91d3","3e34e30ee81ea525"]]},{"id":"56d2378be86a91d3","type":"debug","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"debug 50","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":599.25,"y":2427.833251953125,"wires":[]},{"id":"df18d1223b13f05a","type":"switch","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"","property":"isempty","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"false","repair":false,"outputs":2,"x":1113.25,"y":2290.333251953125,"wires":[["8250415e5f2c89cd","f84248691ed06d3d"],["81183f4703a06f49"]]},{"id":"8250415e5f2c89cd","type":"debug","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"debug 51","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":1665.25,"y":2284.333251953125,"wires":[]},{"id":"312691f152807a49","type":"function","z":"741c6acbed17d504","name":"most downloads last week","func":"var kvs = Object.keys(msg.downloads).map((k) => { return [k, msg.downloads[k]]}).filter( (d) => { return d[0] != \"undefined\" })\nkvs = kvs.sort( (a,b) => { return a[1] < b[1] ? 1 : -1 })\n\nvar orig = [...kvs]\n\nkvs.length = 100;\n\nreturn [\n    {\n        ...msg,\n        payload: [{\n            \"series\": kvs.map((v) => { return v[0] }),\n            \"data\": kvs.map((v) => { return [v[1]] }),\n            \"labels\": [\"Types\"]\n        }]\n    },\n    {\n        ...msg,\n        payload: kvs.map((v) => {\n            var mod = msg.payload.modules.filter((d) => { return d.id == v[0] })[0];\n            return {\n                \"value\": v[0],\n                \"count\": parseInt(v[1]),\n                \"version\": mod.version,\n                \"desc\": mod.description,\n                \"tags\": (mod.keywords || []).map(d => { return { tag: d } })\n            }\n        })\n    },\n    {\n        ...msg,\n        payload: orig\n    }\n]","outputs":3,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1259,"y":1969,"wires":[["c9f5e8734dc46760"],["c407ee428bcd3fb7"],["1af6681cc3275b11"]]},{"id":"67659a26f732abce","type":"change","z":"741c6acbed17d504","name":"","rules":[{"t":"set","p":"downloads","pt":"msg","to":"downloads","tot":"flow","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":1969,"wires":[["312691f152807a49"]]},{"id":"c9f5e8734dc46760","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":11,"width":12,"height":20,"label":"top 100 downloaded packages","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1897.000129699707,"y":1963,"wires":[[]]},{"id":"1af6681cc3275b11","type":"debug","z":"741c6acbed17d504","name":"complete list of download numbers","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1564.0001220703125,"y":2136.666748046875,"wires":[]},{"id":"c407ee428bcd3fb7","type":"template","z":"741c6acbed17d504","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<dl>\n{{#payload}}\n  <dt><b><a target=\"_blank\" href=\"https://flows.nodered.org/search?term={{ value }}\">{{ value}}</a></b> ({{count}})</dt>\n  <dd><i>{{ version }}</i> {{#tags}}{{tag}},{{/tags}}<br><i>{{ desc }}</i></dd>\n{{/payload}}\n</dl>\n","output":"str","x":1559,"y":2094,"wires":[["c891cade66e07a2f"]]},{"id":"c891cade66e07a2f","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"Top 100 downloaded packages","order":19,"width":12,"height":15,"format":"<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1897.000129699707,"y":2096,"wires":[[]]},{"id":"793ef02569caa901","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"TItle 4","order":18,"width":12,"height":1,"format":"<h2>Top 100 downloaded packages - last week numbers</h2>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1817.000129699707,"y":2028,"wires":[[]]},{"id":"359d48a6b99d46c9","type":"change","z":"741c6acbed17d504","g":"9b48b443f84a0653","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"downloads","tot":"flow","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":1294.25,"y":2739.833251953125,"wires":[["e5dee8ee63cc44c3"]]},{"id":"2d9d68e96c33a00b","type":"inject","z":"741c6acbed17d504","g":"9b48b443f84a0653","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1110.25,"y":2739.833251953125,"wires":[["359d48a6b99d46c9"]]},{"id":"e5dee8ee63cc44c3","type":"function","z":"741c6acbed17d504","g":"9b48b443f84a0653","name":"function 12","func":"msg.payload = Object.keys(msg.payload).length\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1495.25,"y":2739.833251953125,"wires":[["e927cfffadbcf09a"]]},{"id":"e927cfffadbcf09a","type":"debug","z":"741c6acbed17d504","g":"9b48b443f84a0653","name":"debug 52","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","statusVal":"payload","statusType":"auto","x":1665.25,"y":2739.833251953125,"wires":[]},{"id":"cb7aa51cff5e5580","type":"http request","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://catalogue.nodered.org/catalogue.json?_={{ payload }}","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":966.25,"y":3077,"wires":[["8045064c5212858b"]]},{"id":"0280b91f32c74573","type":"function","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"function 13","func":"msg.versions = msg.versions || {};\n\nvar module = msg.modules.pop();\n\nif ( !module ) {\n    return [ \n        undefined,\n        msg\n    ]\n} else {\n    return [\n        {\n            ...msg,\n            url: \"https://registry.npmjs.org/\" + module.id,\n            module: module,\n            isempty: msg.versions[module.id] == undefined,\n        },\n        undefined\n    ]\n}","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1497.25,"y":2966.25,"wires":[["8f7f852a46655a05"],["3d4e76c8dc54e012"]]},{"id":"ce3e7eaaf9f9ac2d","type":"http request","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"","method":"GET","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":true,"headers":[],"x":319.75,"y":2992.75,"wires":[["525ff4bef34b3a66"]]},{"id":"f4847a5dba23f723","type":"delay","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"","pauseType":"delay","timeout":"750","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":1381.75,"y":3086,"wires":[["0280b91f32c74573"]]},{"id":"c0740d5553947cfd","type":"debug","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"debug 53","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":1665.25,"y":3175.875,"wires":[]},{"id":"8045064c5212858b","type":"change","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"","rules":[{"t":"set","p":"versions","pt":"msg","to":"versions","tot":"flow","dc":true},{"t":"set","p":"modules","pt":"msg","to":"payload.modules","tot":"msg","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":1169.25,"y":3077,"wires":[["0280b91f32c74573"]]},{"id":"525ff4bef34b3a66","type":"function","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"function 14","func":"msg.versions = msg.versions || {}\n\nif (msg.payload._id) {\n    msg.versions[msg.payload._id] = {\n        releases: { ...msg.payload.time },\n        readme: !!msg.payload.readme,\n        readmeFilename: !!msg.payload.readmeFilename,\n        description: msg.payload.description,\n        maintainers: msg.payload.maintainers,\n        contributors: msg.payload.contributors,\n        disttags: { ...msg.payload[\"dist-tags\"] }\n    }\n\n    return [\n        msg,\n        undefined\n    ]\n} else {\n    return [\n        undefined,\n        msg\n    ]\n}\n","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":477.25,"y":3183.5,"wires":[["431906ed74e84938"],["0f31a57b165af276"]]},{"id":"431906ed74e84938","type":"change","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"","rules":[{"t":"set","p":"versions","pt":"flow","to":"versions","tot":"msg","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":1146.25,"y":3175.875,"wires":[["c0740d5553947cfd","f4847a5dba23f723"]]},{"id":"8b993b2ec9fecad0","type":"inject","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"Trigger download number collection","props":[{"p":"payload"}],"repeat":"21600","crontab":"","once":false,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":677.25,"y":3076.5,"wires":[["cb7aa51cff5e5580"]]},{"id":"042c5cb781781ffe","type":"catch","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"","scope":["ce3e7eaaf9f9ac2d"],"uncaught":false,"x":338.25,"y":2966,"wires":[["a0af637a6816c6e7","edde60f0b0917325"]]},{"id":"a0af637a6816c6e7","type":"debug","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"debug 54","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":607.25,"y":2987,"wires":[]},{"id":"8f7f852a46655a05","type":"switch","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"","property":"isempty","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"false","repair":false,"outputs":2,"x":948.25,"y":2886.5,"wires":[["ad21b0ba9c731507","0280b91f32c74573"],["ce3e7eaaf9f9ac2d"]]},{"id":"ad21b0ba9c731507","type":"debug","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"debug 55","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":1663.25,"y":2884.5,"wires":[]},{"id":"1e4ca5108278c8bd","type":"change","z":"741c6acbed17d504","g":"8ca7d5fd124078bb","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"versions","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":1294.25,"y":3334.5,"wires":[["8850a08e7b35d028"]]},{"id":"ddd4da103f23a14f","type":"inject","z":"741c6acbed17d504","g":"8ca7d5fd124078bb","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1110.25,"y":3334.5,"wires":[["1e4ca5108278c8bd"]]},{"id":"8850a08e7b35d028","type":"function","z":"741c6acbed17d504","g":"8ca7d5fd124078bb","name":"function 15","func":"msg.payload = Object.keys(msg.payload).length\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1495.25,"y":3334.5,"wires":[["cd6ca105174a79b8"]]},{"id":"cd6ca105174a79b8","type":"debug","z":"741c6acbed17d504","g":"8ca7d5fd124078bb","name":"debug 56","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","statusVal":"payload","statusType":"auto","x":1665.25,"y":3334.5,"wires":[]},{"id":"25bc3304e70968ae","type":"change","z":"741c6acbed17d504","name":"","rules":[{"t":"set","p":"versions","pt":"msg","to":"versions","tot":"flow","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":2179.3334217071533,"wires":[["cab121243e501204"]]},{"id":"cab121243e501204","type":"function","z":"741c6acbed17d504","name":"top maintainers","func":"var maintainers = {}\n\nObject.keys(msg.versions).forEach( (packname) => {\n    (msg.versions[packname].maintainers || []).forEach( (man) => {\n        maintainers[man.name] = (maintainers[man.name] || 0) + 1\n    })\n})\n\nvar kvs = Object.keys(maintainers).map( (k) => { return [k, maintainers[k]]} )\nkvs = kvs.sort((a, b) => { return a[1] < b[1] ? 1 : -1 })\n\nkvs.length = 100;\n\nreturn {\n        ...msg,\n        payload: [{\n            \"series\": kvs.map((v) => { return v[0] }),\n            \"data\": kvs.map((v) => { return [v[1]] }),\n            \"labels\": [\"Maintainer\"]\n        }]\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1201,"y":2179.3334217071533,"wires":[["d3960b2b800f214f"]]},{"id":"d3960b2b800f214f","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":20,"width":12,"height":20,"label":"top 100 package maintainers","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1887.000129699707,"y":2179.3334217071533,"wires":[[]]},{"id":"3e34e30ee81ea525","type":"delay","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":986.25,"y":2391,"wires":[["f84248691ed06d3d"]]},{"id":"7795563e2648cb7a","type":"debug","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"done","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":1655.25,"y":2461,"wires":[]},{"id":"3d4e76c8dc54e012","type":"debug","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"done","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":1655.25,"y":3035,"wires":[]},{"id":"edde60f0b0917325","type":"delay","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":943.25,"y":2961,"wires":[["0280b91f32c74573"]]},{"id":"200dd7b329a4191e","type":"inject","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"Reset","props":[{"p":"payload"}],"repeat":"10800","crontab":"","once":false,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":463,"y":2533,"wires":[["5a18cef8307f4179"]]},{"id":"5a18cef8307f4179","type":"change","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"","rules":[{"t":"set","p":"downloads","pt":"flow","to":"{}","tot":"json","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":662,"y":2533,"wires":[["5ab1307cde32f1fb"]]},{"id":"b4baba4cbfaebef8","type":"inject","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"Reset","props":[{"p":"payload"}],"repeat":"10800","crontab":"","once":false,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":531,"y":3038,"wires":[["6f70a024e1b52425"]]},{"id":"6f70a024e1b52425","type":"change","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"","rules":[{"t":"set","p":"versions","pt":"flow","to":"{}","tot":"json","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":735,"y":3038,"wires":[["cb7aa51cff5e5580"]]},{"id":"e381d4b2527eb33b","type":"debug","z":"741c6acbed17d504","g":"50d3daf2d40242cd","name":"empty download data","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":618,"y":2636,"wires":[]},{"id":"0f31a57b165af276","type":"debug","z":"741c6acbed17d504","g":"f98a6a1875c36277","name":"empty version data","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"true","targetType":"full","statusVal":"","statusType":"counter","x":704,"y":3225,"wires":[]},{"id":"01cb0c42ba918c34","type":"ui_group","name":"Default","tab":"e2ef93495fbb5da3","order":1,"disp":true,"width":"12","collapse":false,"className":""},{"id":"e2ef93495fbb5da3","type":"ui_tab","name":"Package Analysis","icon":"dashboard","disabled":false,"hidden":false}]