[{"id":"741c6acbed17d504","type":"tab","label":"[experimental] Node-RED Community catalogue","disabled":false,"info":"### Description\n\nA basic analyses of the Node-RED Community catalogue.\n\nTakes the catalogue details and tries to make nice looking graphs from it.\n\n![img](https://cdn.openmindmap.org/content/1698262081584_Screen_Shot_2023-10-25_at_21.27.57.png)\n\n![img](https://cdn.openmindmap.org/content/1698262103086_Screen_Shot_2023-10-25_at_21.28.19.png)\n\n![img](https://cdn.openmindmap.org/content/1698262124007_Screen_Shot_2023-10-25_at_21.28.40.png)\n\n","env":[]},{"id":"206d219714878a64","type":"http request","z":"741c6acbed17d504","name":"","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://catalogue.nodered.org/catalogue.json?_={{ payload }}","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":519,"y":1367.2777910232544,"wires":[["f544e75095b4b089","a9e223ba3da5fd6c","d4a8db88a2d62d2b","142f96b4a47de0ec","e51fbfae8f6f88d4","e6d53528d2196e15","fb5a017272acb096","9792fe31e9eb49ec","ca3f486d4be3fb14","2f0167db58f7ce54","27e9cacefbc9e0e0","50b0c642f7829303"]]},{"id":"db7468f93f6d28c4","type":"inject","z":"741c6acbed17d504","name":"Generate initial data","props":[],"repeat":"","crontab":"","once":true,"onceDelay":"1","topic":"","x":231.1111068725586,"y":1367.2777910232544,"wires":[["206d219714878a64"]]},{"id":"f544e75095b4b089","type":"debug","z":"741c6acbed17d504","name":"debug 48","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":506,"y":1480,"wires":[]},{"id":"dec7a25e92772aec","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":3,"width":12,"height":20,"label":"top keywords, used by at least 10 modules","chartType":"bar","legend":"true","xformat":"auto","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1961.1112060546875,"y":902.5,"wires":[[]]},{"id":"a9e223ba3da5fd6c","type":"function","z":"741c6acbed17d504","name":"top keywords","func":"var keywords = {};\nmsg.payload.modules.forEach(function(module) {\n    (module.keywords || []).forEach(function(keyword) {\n        keyword = keyword.toLowerCase()\n        keywords[keyword] ||= 0\n        keywords[keyword] += 1\n    });\n});\n\n\ndelete keywords[\"node-red\"]\ndelete keywords[\"node-red-contrib\"]\ndelete keywords[\"node-red-contrib-contribgen\"]\n// delete keywords[\"iot\"]\ndelete keywords[\"node\"]\ndelete keywords[\"nodered\"]\n\nvar keys = Object.keys(keywords);\nvar kvs = keys.map((k) => { return [k, keywords[k]]})\nkvs = kvs.sort( (a,b) => { return a[1] > b[1] ? 1 : -1 })\n\nmsg.payload = [{\n    \"series\": kvs.filter( (v) => { return v[1] > 9 }).map((v) => { return v[0]}),\n    \"data\": kvs.filter((v) => { return v[1] > 9 }).map((v) => { return [v[1]] }),\n    \"labels\": [\"Keywords\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":878,"y":902.5,"wires":[["dec7a25e92772aec"]]},{"id":"d4a8db88a2d62d2b","type":"function","z":"741c6acbed17d504","name":"updates per day","func":"var lastestUpdates = {};\nmsg.payload.modules.forEach(function(module) {\n    module.updated_at = module.updated_at.split(\"T\")[0]\n\n    lastestUpdates[module.updated_at] ||= 0\n    lastestUpdates[module.updated_at] += 1\n});\n\nvar keys = Object.keys(lastestUpdates);\nvar kvs = keys.map((k) => { return [k, lastestUpdates[k]]})\nkvs = kvs.sort( (a,b) => { return Date.parse(a[0]) < Date.parse(b[0]) ? 1 : -1 })\n\nkvs.length = 1000\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0]}),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Days\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":878,"y":983.5,"wires":[["bdcf58f8b5f0a53f"]]},{"id":"bdcf58f8b5f0a53f","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":4,"width":12,"height":20,"label":"updates per day, last 1000 days","chartType":"bar","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1921.1112060546875,"y":983.5,"wires":[[]]},{"id":"142f96b4a47de0ec","type":"function","z":"741c6acbed17d504","name":"top version numbers","func":"var topVersionNunbers = {};\n\nmsg.payload.modules.forEach(function(module) {\n    topVersionNunbers[module.version] ||= 0\n    topVersionNunbers[module.version] += 1\n});\n\nvar keys = Object.keys(topVersionNunbers);\nvar kvs = keys.map((k) => { return [k, topVersionNunbers[k]]})\nkvs = kvs.sort( (a,b) => { return a[1] < b[1] ? 1 : -1 })\n\nkvs.length = 100\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0]}),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Versions\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":898,"y":1083,"wires":[["da734d225bc3a03b"]]},{"id":"da734d225bc3a03b","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":5,"width":12,"height":20,"label":"top 100 version numbers","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1901.1112060546875,"y":1083,"wires":[[]]},{"id":"e51fbfae8f6f88d4","type":"function","z":"741c6acbed17d504","name":"last 100 updates","func":"var latestPackageUpdates = [];\n\nmsg.payload.modules.forEach(function(module) {\n    latestPackageUpdates.push([\n        module.id,\n        module.updated_at.split(\"T\")[0],\n        module.description,\n        module.version,\n        module.keywords\n    ])\n});\n\nkvs = latestPackageUpdates.sort( (a,b) => { return Date.parse(a[1]) <= Date.parse(b[1]) ? 1 : -1 })\n\nkvs.length = 100\n\nmsg.payload = kvs.map((v) => {\n    return {\n        \"value\": v[0],\n        \"date\": v[1],\n        \"desc\": v[2],\n        \"version\": v[3],\n        \"tags\": (v[4] || []).map(d => { return { tag: d } })\n    }\n})\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":888,"y":1200,"wires":[["d34e2aac0af1c3b4"]]},{"id":"696d4b7a9edc9456","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"List of latest updated packages","order":10,"width":12,"height":15,"format":"<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1921.1112060546875,"y":1200,"wires":[[]]},{"id":"d34e2aac0af1c3b4","type":"template","z":"741c6acbed17d504","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<dl>\n{{#payload}}\n  <dt><b><a target=\"_blank\" href=\"https://flows.nodered.org/search?term={{ value }}\">{{ value}}</a></b> ({{date}})</dt>\n  <dd><i>{{ version }}</i> {{#tags}}{{tag}},{{/tags}}<br>\n  <i>{{ desc }}</i>\n  </dd>\n{{/payload}}\n</dl>\n","output":"str","x":1229,"y":1200,"wires":[["696d4b7a9edc9456"]]},{"id":"476d44ecaa16b0f0","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"TItle","order":9,"width":12,"height":1,"format":"<h2>Last 100 package Updates</h2>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1841.1112060546875,"y":1154,"wires":[[]]},{"id":"e6d53528d2196e15","type":"function","z":"741c6acbed17d504","name":"top major version number","func":"var topVersionNunbers = {};\n\nmsg.payload.modules.forEach(function(module) {\n    topVersionNunbers[module.version.split(\".\")[0]] ||= 0\n    topVersionNunbers[module.version.split(\".\")[0]] += 1\n});\n\nvar keys = Object.keys(topVersionNunbers);\nvar kvs = keys.map((k) => { return [k, topVersionNunbers[k]]})\nkvs = kvs.sort( (a,b) => { return a[1] < b[1] ? 1 : -1 })\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0]}),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Major Version\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":908,"y":1281.5,"wires":[["cd46143e9a042d89"]]},{"id":"cd46143e9a042d89","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":6,"width":12,"height":20,"label":"top major version number (major.minor.patch)","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1971.1112060546875,"y":1281.5,"wires":[[]]},{"id":"fb5a017272acb096","type":"function","z":"741c6acbed17d504","name":"highest defined types","func":"var typeCounts = {};\n\nmsg.payload.modules.forEach(function(module) {\n    typeCounts[module.types.length] ||= 0\n    typeCounts[module.types.length] += 1\n});\n\nvar keys = Object.keys(typeCounts);\nvar kvs = keys.map((k) => { return [k, typeCounts[k]]})\nkvs = kvs.sort( (a,b) => { return parseInt(a[0]) < parseInt(b[0]) ? 1 : -1 })\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0]}),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Type counts\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":898,"y":1365.5,"wires":[["fc97bcdb069767a2"]]},{"id":"fc97bcdb069767a2","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":7,"width":12,"height":20,"label":"node types defined by package","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1921.1112060546875,"y":1365.5,"wires":[[]]},{"id":"9792fe31e9eb49ec","type":"function","z":"741c6acbed17d504","name":"number of types > 20","func":"var topTypeCounts = [];\n\nmsg.payload.modules.forEach(function(module) {\n    topTypeCounts.push([\n        module.id,\n        module.types.length,\n        module.version,\n        module.description,\n        module.keywords\n    ])\n});\n\nvar kvs = topTypeCounts.filter((d) => { \n    return (parseInt(d[1]) > 19 || parseInt(d[1]) == 0 )\n}).sort( (a,b) => { \n    return parseInt(a[1]) <= parseInt(b[1]) ? 1 : -1 \n})\n\nmsg.payload = kvs.map((v) => {\n    return {\n        \"value\": v[0],\n        \"count\": parseInt(v[1]),\n        \"version\": v[2],\n        \"desc\": v[3],\n        \"tags\": (v[4]||[]).map( d => { return { tag: d }})\n    }\n})\n\nreturn [\n    {\n        ...msg,\n        payload: msg.payload.filter( d => { return d.count > 0 })\n    },\n    {\n        ...msg,\n        payload: msg.payload.filter(d => { return d.count == 0 })\n    }\n]","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":898,"y":1559,"wires":[["fc1728e12900a63e"],["75ceb26047ef4853"]]},{"id":"26071b19cfe2addb","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"List of type counts","order":12,"width":12,"height":15,"format":"<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1881.1112060546875,"y":1552,"wires":[[]]},{"id":"fc1728e12900a63e","type":"template","z":"741c6acbed17d504","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<dl>\n{{#payload}}\n  <dt><b><a target=\"_blank\" href=\"https://flows.nodered.org/search?term={{ value }}\">{{ value}}</a></b> ({{count}})</dt>\n  <dd><i>{{ version }}</i> {{#tags}}{{tag}},{{/tags}}<br><i>{{ desc }}</i></dd>\n{{/payload}}\n</dl>\n","output":"str","x":1229,"y":1552,"wires":[["26071b19cfe2addb"]]},{"id":"1cbcf2c1fb513439","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"TItle 2","order":11,"width":12,"height":1,"format":"<h2>Packages with the most types defined (above 20)</h2>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1841.1112060546875,"y":1474,"wires":[[]]},{"id":"0de51abc98bd4b1f","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"List of packages with no node types defined","order":14,"width":12,"height":15,"format":"<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1961.1112060546875,"y":1705.5,"wires":[[]]},{"id":"75ceb26047ef4853","type":"template","z":"741c6acbed17d504","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<dl>\n{{#payload}}\n  <dt><b><a target=\"_blank\" href=\"https://flows.nodered.org/search?term={{ value }}\">{{ value}}</a></b> ({{count}})</dt>\n  <dd><i>{{ version }}</i> {{#tags}}{{tag}},{{/tags}}<br><i>{{ desc }}</i></dd>\n{{/payload}}\n</dl>\n","output":"str","x":1229,"y":1705.5,"wires":[["0de51abc98bd4b1f"]]},{"id":"d52f1947d0f12e32","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"TItle 3","order":13,"width":12,"height":1,"format":"<h2>Packages with no node types defined</h2>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1841.1112060546875,"y":1636,"wires":[[]]},{"id":"2ba7496fdee9fb94","type":"ui_button","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":1,"width":0,"height":0,"passthru":false,"label":"Refresh Data","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":293.77777099609375,"y":546.2222080230713,"wires":[["6e28a0aaf183ed8a","7a73184fb136e7db"]]},{"id":"ca3f486d4be3fb14","type":"function","z":"741c6acbed17d504","name":"top developers","func":"var topDevelopers = {};\n\nmsg.payload.modules.forEach(function(module) {\n    var devname = module.id.split(\"/\")\n    if ( devname.length > 1 ) {\n        topDevelopers[devname[0]] ||= 0\n        topDevelopers[devname[0]] += 1\n    }\n});\n\nvar keys = Object.keys(topDevelopers);\nvar kvs = keys.map((k) => { return [k, topDevelopers[k]]})\nkvs = kvs.sort( (a,b) => { return a[1] < b[1] ? 1 : -1 })\n\nkvs.length = 100;\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0]}),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Developers\"]\n}]\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":878,"y":1787,"wires":[["5353fbb10c120179"]]},{"id":"5353fbb10c120179","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":8,"width":12,"height":20,"label":"top 100 developers","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1881.1112060546875,"y":1787,"wires":[[]]},{"id":"e8c4690585fb2a41","type":"catch","z":"741c6acbed17d504","name":"","scope":null,"uncaught":false,"x":159,"y":1964,"wires":[["3fe48b832b51cf6b"]]},{"id":"3fe48b832b51cf6b","type":"debug","z":"741c6acbed17d504","name":"EXCEPTIONS WILL HAPPEN","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":421.1111259460449,"y":1962.8889141082764,"wires":[]},{"id":"6e28a0aaf183ed8a","type":"change","z":"741c6acbed17d504","name":"reset charts","rules":[{"t":"set","p":"payload","pt":"msg","to":"[]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1239,"y":546.2222080230713,"wires":[["dec7a25e92772aec","bdcf58f8b5f0a53f","da734d225bc3a03b","cd46143e9a042d89","fc97bcdb069767a2","696d4b7a9edc9456","26071b19cfe2addb","0de51abc98bd4b1f","5353fbb10c120179","08e9c9ce8d47bd36","c4d0f31a52436e6c","911d68596b80740e"]]},{"id":"7a73184fb136e7db","type":"delay","z":"741c6acbed17d504","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":437.1111602783203,"y":908.2222175598145,"wires":[["206d219714878a64"]]},{"id":"2f0167db58f7ce54","type":"function","z":"741c6acbed17d504","name":"top developers","func":"var prefixedPackages = 0;\nvar totalPackages = 0;\n\nmsg.payload.modules.forEach(function(module) {\n    var devname = module.id.split(\"/\")\n\n    totalPackages += 1\n    if ( devname.length > 1 ) {\n        prefixedPackages += 1\n    }\n});\n\nmsg.prefixedPackages = prefixedPackages;\nmsg.totalPackages = totalPackages;\nmsg.nonPrefixedPackages = totalPackages - prefixedPackages;\nmsg.lastUpdated = msg.payload.updated_at;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":878,"y":829.5556030273438,"wires":[["46e5086ca7d0e5d1"]]},{"id":"08e9c9ce8d47bd36","type":"ui_template","z":"741c6acbed17d504","group":"01cb0c42ba918c34","name":"Statistics","order":2,"width":12,"height":4,"format":"\n<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1851.1112060546875,"y":829.5556030273438,"wires":[[]]},{"id":"46e5086ca7d0e5d1","type":"template","z":"741c6acbed17d504","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<h2>Packages</h2>\n\nTotal: <b>{{ totalPackages }}</b><br>\nPrefixed: <b>{{ prefixedPackages }}</b><br>\nNon-Prefixed: <b>{{ nonPrefixedPackages }}</b><br>\nLast updated at: <b>{{ lastUpdated }}</b><br>\n","output":"str","x":1229,"y":829.5556030273438,"wires":[["08e9c9ce8d47bd36"]]},{"id":"27e9cacefbc9e0e0","type":"function","z":"741c6acbed17d504","name":"last updates by year","func":"var groupByDate = {};\n\nmsg.payload.modules.forEach(function(module) {\n    var day = module.updated_at.split(\"T\")[0];\n\n    var month = day.split(\"-\").slice(0, 2).join(\"-\")\n    var year = day.split(\"-\").slice(0, 1).join(\"-\")\n\n    // groupByDate[month] = (groupByDate[month] || 0) + 1\n    groupByDate[year] = (groupByDate[year] || 0) + 1\n});\n\nvar keys = Object.keys(groupByDate);\nvar kvs = keys.map((k) => { return [k, groupByDate[k]] })\nkvs = kvs.sort((a, b) => { return parseInt(a[0]) < parseInt(b[1]) ? 1 : -1 })\n\nmsg.payload = [{\n    \"series\": kvs.map((v) => { return v[0] }),\n    \"data\": kvs.map((v) => { return [v[1]] }),\n    \"labels\": [\"Major Version\"]\n}]\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":898,"y":1874.4445972442627,"wires":[["c4d0f31a52436e6c"]]},{"id":"c4d0f31a52436e6c","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":8,"width":12,"height":20,"label":"last update of packages by year","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1921.1112060546875,"y":1874.4445972442627,"wires":[[]]},{"id":"50b0c642f7829303","type":"function","z":"741c6acbed17d504","name":"overlapping types","func":"var types = {};\n\nmsg.payload.modules.forEach( (module) => {\n    (module.types || []).forEach( (typ) => {\n        types[typ] = ( types[typ] || [] ).concat( [module.id] )\n    });\n});\n\n// occurs multiple times but seems to be ignored. Some packages\n// define this as a node type several times - some generational \n// error I assume.\ndelete types[\"__errors__\"]; \n\nvar kvs = Object.keys(types).map((k) => { return [k, types[k]]}).filter( (d) => {\n    return d[1].length > 1\n})\nkvs = kvs.sort( (a,b) => { return a[1].length < b[1].length ? 1 : -1 })\n\nvar orig = [...kvs]\n\nkvs.length = 100;\n\nreturn [\n    {\n        ...msg,\n        payload: [{\n            \"series\": kvs.map((v) => { return v[0] }),\n            \"data\": kvs.map((v) => { return [v[1].length] }),\n            \"labels\": [\"Types\"]\n        }]\n    },\n    {\n        ...msg,\n        payload: orig\n    }\n]","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":888,"y":1953,"wires":[["911d68596b80740e"],["39a232c1f0d6f9cf"]]},{"id":"911d68596b80740e","type":"ui_chart","z":"741c6acbed17d504","name":"","group":"01cb0c42ba918c34","order":8,"width":12,"height":20,"label":"top 100 overlapping types","chartType":"bar","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"hello","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#5cb47c","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":1901.1112060546875,"y":1951,"wires":[[]]},{"id":"39a232c1f0d6f9cf","type":"debug","z":"741c6acbed17d504","name":"list of overlapping types","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1241.25,"y":2035,"wires":[]},{"id":"01cb0c42ba918c34","type":"ui_group","name":"Default","tab":"e2ef93495fbb5da3","order":1,"disp":true,"width":"12","collapse":false,"className":""},{"id":"e2ef93495fbb5da3","type":"ui_tab","name":"Package Analysis","icon":"dashboard","disabled":false,"hidden":false}]