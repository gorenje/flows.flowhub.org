[{"id":"7b6549de378f8fda","type":"tab","label":"[Hack] Trigger Node button click via server event","disabled":false,"info":"::: aim\n\nTriggering a frontend node button via a server-side message.\n\n:::\n\n::: requirements\n\nThis requirements the following Node-RED nodes:\n\n- [introspection package containing the ClientCode node](https://flows.nodered.org/node/@gregoriusrippenstein/node-red-contrib-introspection), version >= 0.4.2\n\n:::\n\n::: background\n\nSometimes a hack is better than code. In this case I wanted to trigger a node which has a button via a backend (i.e. server side) event. This would normally be done with a input port and a message but becuase this particular node had a button, the input port wasn't a good idea - visually it does not work.\n\nSince the button is a frontend-only (i.e. client side) feature, it isn't possible to trigger the button from the backend.\n\nSo how to do this? Using the <a class=\"ahl-node-only\" data-ids=\"f48e7e9c1931da58\">ClientCode</a> node that encapsulates frontend code but is triggered from the backend.\n\n:::\n\n::: explanation\n\nThe <a class=\"ahl-group-only\" data-ids=\"8deceb2a31a78b90\">top group</a> contains the inject that fires every 5 secounds. It triggers the ClientCode node which contains this code:\n\n```javascript\nvar nodeId = \"6ec4bbd889956539\";\n\nvar evnt = document.createEvent('SVGEvents');\nevnt.initEvent('click', true, true);\n$('#' + nodeId + ' .red-ui-flow-node-button-button')[0].dispatchEvent(evnt);\n```\n\nThe inject labelled <a class=\"ahl-node-only\" data-ids=\"6ec4bbd889956539\">*hello world*</a> happens to have the ID `6ec4bbd889956539` and its button happens to have the CSS class `red-ui-flow-node-button-button` - the event is dispatched to the button, simulating a mouse click.\n\nThis only works if the *hello world* inject button is shown in the browser, i.e., the flow tab containing it is being viewed.\n\nThe trigger node, i.e., the client code node can be hidden in another flow, it does not need to be in focus.\n\nAfter 5 seconds, the debug panel contains this:\n\n![img](https://cdn.openmindmap.org/content/1694187989217_Screen_Shot_2023-09-08_at_17.46.05.png)\n\nand every five seconds after that.\n\n:::\n\n","env":[]},{"id":"4731a41f5ed9d43a","type":"group","z":"7b6549de378f8fda","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["6ec4bbd889956539","c2c011e67e3899ef"],"x":1013,"y":650,"w":502,"h":82},{"id":"8deceb2a31a78b90","type":"group","z":"7b6549de378f8fda","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["f48e7e9c1931da58","f8a41a14012a26b4"],"x":277,"y":368,"w":584,"h":82},{"id":"f48e7e9c1931da58","type":"ClientCode","z":"7b6549de378f8fda","g":"8deceb2a31a78b90","name":"Trigger click on button.","clientcode":"/*\nTake from https://stackoverflow.com/questions/18991680/d3-trigger-mouseover-event/30803644#30803644\n\nTested in Firefox, your mileage might vary.\n*/\nvar nodeId = \"6ec4bbd889956539\";\n\nvar evnt = document.createEvent('SVGEvents');\nevnt.initEvent('click', true, true);\n$('#' + nodeId + ' .red-ui-flow-node-button-button')[0].dispatchEvent(evnt);\n\n/*\nalternative:\n\nvar evnt = new MouseEvent('SVGEvents', {});\n\n$('#' + nodeId + ' .red-ui-flow-node-button-button')[0].dispatchEvent(evnt);\n*/\n","format":"javascript","x":735,"y":409,"wires":[[]]},{"id":"f8a41a14012a26b4","type":"inject","z":"7b6549de378f8fda","g":"8deceb2a31a78b90","name":"every 5 secs","props":[],"repeat":"5","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":403,"y":409,"wires":[["f48e7e9c1931da58"]]},{"id":"6ec4bbd889956539","type":"inject","z":"7b6549de378f8fda","g":"4731a41f5ed9d43a","name":"hello world","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"hello world","payloadType":"str","x":1119,"y":691,"wires":[["c2c011e67e3899ef"]]},{"id":"c2c011e67e3899ef","type":"debug","z":"7b6549de378f8fda","g":"4731a41f5ed9d43a","name":"debug 42","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1409,"y":691,"wires":[]}]