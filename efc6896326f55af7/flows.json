[{"id":"73c1460c85149b2d","type":"subflow","name":"RSS Feeder with Buffer","info":"","category":"","in":[{"x":154,"y":364,"wires":[{"id":"7cd0dfae4dc75e52"},{"id":"28b73b42c6addcc0"}]}],"out":[{"x":1675,"y":342,"wires":[{"id":"18f98d39cb95fa5b","port":2}]},{"x":1735,"y":275,"wires":[{"id":"18f98d39cb95fa5b","port":1}]},{"x":1735,"y":216,"wires":[{"id":"18f98d39cb95fa5b","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","outputLabels":["New items","All items in individual messages","All items as array limited by limit"],"icon":"font-awesome/fa-rss","status":{"x":1204,"y":741,"wires":[{"id":"7f6ea1bf517e2faf","port":0},{"id":"251bbddfd340b336","port":0},{"id":"28c4285457977303","port":0}]}},{"id":"28b73b42c6addcc0","type":"http request","z":"73c1460c85149b2d","name":"","method":"GET","ret":"txt","paytoqs":"ignore","url":"{{{ feedUrl }}}","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":true,"headers":[{"keyType":"other","keyValue":"user-agent","valueType":"other","valueValue":"Mozilla/5.0 (Node-RED)"},{"keyType":"other","keyValue":"accept","valueType":"other","valueValue":"application/rss+xml,text/html,application/xhtml+xml,application/xml"}],"x":388,"y":788.5,"wires":[["7cd0dfae4dc75e52"]]},{"id":"3c68b55d65e784c4","type":"switch","z":"73c1460c85149b2d","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":852,"y":532.5,"wires":[["7f427620331e50fc"],["7f6ea1bf517e2faf"]]},{"id":"fa6105585e7d5bca","type":"catch","z":"73c1460c85149b2d","name":"","scope":["3c68b55d65e784c4","7cd0dfae4dc75e52","bda34b51c82f362e","18f98d39cb95fa5b"],"uncaught":false,"x":790,"y":717.5,"wires":[["251bbddfd340b336"]]},{"id":"7cd0dfae4dc75e52","type":"batch","z":"73c1460c85149b2d","name":"","mode":"count","count":"2","overlap":0,"interval":10,"allowEmptySequence":false,"topics":[],"x":569,"y":363,"wires":[["bda34b51c82f362e"]]},{"id":"bda34b51c82f362e","type":"join","z":"73c1460c85149b2d","name":"","mode":"auto","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":712,"y":456,"wires":[["3c68b55d65e784c4"]]},{"id":"251bbddfd340b336","type":"change","z":"73c1460c85149b2d","name":"set status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\t    \"shape\": \"dot\",\t    \"colour\": \"red\",\t    \"title\": $$.error.message\t}","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":718.5,"wires":[[]]},{"id":"7f6ea1bf517e2faf","type":"change","z":"73c1460c85149b2d","name":"set status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\t    \"shape\": \"dot\",\t    \"colour\": \"red\",\t    \"title\": \"Failed: \" & $$.statusCode\t}","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":973,"y":640.5,"wires":[[]]},{"id":"28c4285457977303","type":"status","z":"73c1460c85149b2d","name":"","scope":["28b73b42c6addcc0","18f98d39cb95fa5b"],"x":932,"y":788.5,"wires":[[]]},{"id":"7f427620331e50fc","type":"xml","z":"73c1460c85149b2d","name":"","property":"payload[1]","attr":"","chr":"","x":1019,"y":409.5,"wires":[["18f98d39cb95fa5b"]]},{"id":"18f98d39cb95fa5b","type":"function","z":"73c1460c85149b2d","name":"function 13","func":"node.seen = this.context.get(\"seen\") || {};\nnode.stack = this.context.get(\"stack\") || [];\n\ndelete msg.responseCookies;\ndelete msg.headers;\n\nvar rFirst = (ary) => {\n    if (ary && ary[0]) { return ary[0]}\n    return undefined\n};\n\nvar dmsg = undefined;\n\n// Hacker news feeds\nif (msg.payload[1].rss) {\n    var items = msg.payload[1].rss.channel[0].item;\n\n    for ( var idx = 0 ; idx < items.length ; idx++ ) {\n        var article = items[idx];\n        var guid = article.guid[0][\"_\"];\n\n        if (!(guid in node.seen) || (node.seen[guid] !== 0 && node.seen[guid] != rFirst(article.pubDate))) {\n            node.seen[guid] = rFirst(article.pubDate);\n\n            dmsg = {\n                ...msg,\n                payload: {\n                    guid: guid,\n                    link:  rFirst(article.origlink) || rFirst(article.link),\n                    comments: rFirst(article.comments),\n                    description: rFirst(article.description),\n                    author: rFirst(article[\"dc:creator\"]),\n                    title: rFirst(article.title)\n                }\n            };\n\n            node.stack.unshift(dmsg);\n\n            if (node.ignorefirst === true && node.donefirst === false) {\n                // do nothing\n            }\n            else {\n                node.send([null, null, dmsg]);\n            }\n        }\n    }\n}\n\n// Wikipedia\nif (msg.payload[1].feed) {\n    for (var idx = 0; idx < msg.payload[1].feed.entry.length; idx++) {\n        var article = msg.payload[1].feed.entry[idx];\n        var guid = rFirst(article.id);\n\n        if (!(guid in node.seen) || (node.seen[guid] !== 0 && node.seen[guid] != rFirst(article.updated))) {\n            node.seen[guid] = rFirst(article.updated);\n\n            dmsg = {\n                ...msg,\n                payload: {\n                    guid: guid,\n                    link: guid,\n                    title: rFirst(article.title),\n                    comments: \"\",\n                    description: rFirst(article.summary),\n                    author: rFirst(rFirst(article[\"author\"])[\"name\"]),\n                }\n            };\n\n            node.stack.unshift(dmsg);\n\n            if (node.ignorefirst === true && node.donefirst === false) {\n                // do nothing\n            }\n            else {\n                node.send([null, null, dmsg]);\n            }            \n        }        \n    }\n}\n\n\nnode.stack.length = msg.feedLimit || 30;\nnode.stack.forEach(function (element) {\n    node.send([null, element, null]);\n});\nnode.send([{ ...msg, payload: node.stack }, null, null])\nnode.status({ fill: \"green\", shape: \"ring\", text: \"done: \" + Object.keys(node.seen).length });\n\nthis.context.set(\"seen\", node.seen);\nif (Object.keys(node.seen).length > 500 ) {\n    this.context.set(\"seen\", {});\n}\nthis.context.set(\"stack\", node.stack);","outputs":3,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1273,"y":408.5,"wires":[[],[],[]]},{"id":"f6cb5ce38fddebe4","type":"catch","z":"73c1460c85149b2d","name":"","scope":["28b73b42c6addcc0"],"uncaught":false,"x":390,"y":764.5,"wires":[["7cd0dfae4dc75e52"]]},{"id":"efc6896326f55af7","type":"tab","label":"[RSS] Visualisation","disabled":false,"info":"::: aim\n\nCollect together various RSS/Atom feeds and provide dashboard elements lists of links. From all sources, there should also be a random link page whereby a single link is shown and updated with each update.\n\nTaking [Hacker News](https://hnrss.org/newcomments) and [Wikipedia](https://en.wikipedia.org/w/api.php?hidebots=1&hidecategorization=1&hideWikibase=1&urlversion=1&days=7&limit=50&action=feedrecentchanges&feedformat=atom) as sources, provide an dashboard overview of recent happenings.\n\n:::\n\n::: prereq\n\n- [feedparser](https://www.npmjs.com/package/feedparser) - [doco](https://github.com/danmactough/node-feedparser#examples)\n\n:::\n\n::: requirements\n\nAssumed is that installation of the [Node-RED dashboard](https://flows.nodered.org/node/node-red-dashboard) component via the palette manager.\n\n:::\n\n### Flow Explanation\n\nThis flow also contains the `RSS Feeder with Buffer` subflow. The subflow collects together feed items and ensures there are no duplication in the collection of RSS links.\n\nThe main groups are:\n\n- <a class=\"ahl-group-only\" data-ids=\"5a899916a04657c2\">RSS sources</a> which regular update the data by triggering data collection\n- <a class=\"ahl-group-only\" data-ids=\"455a48126bb4679c\">Logic</a> for handling the RSS content, e.g. removing unwanted text or bot updates. This group also generates the content for the <a class=\"ahl-node-only\" data-ids=\"071d7bae4750b483,168bd8528db5ce2b,071d7bae4750b483,781c6d02fec073f6,242fe3dcd50b35fc\">UI templates</a>.\n- <a class=\"ahl-group-only\" data-ids=\"832e39cd06bd8aea\">Random page logic</a> which takes all sources and produces a single link.\n- <a class=\"ahl-group-only\" data-ids=\"813666329db1e709\">UI Dashboard</a> defintions.\n- <a class=\"ahl-group-only\" data-ids=\"2844ae0db0d1d6b2\">Exception handling</a> that does not do much - this isn't rocket guidance.\n\n### Example usage\n\nThis flow is available at [Open Mind Map dot Org](https://demo.openmindmap.org/ui/#!/1).\n\n### Preview\n\n![img](https://cdn.openmindmap.org/content/1691139568497_Screen_Shot_2023-08-04_at_10.56.51.png)\n\n<!--\n// [[RSS] Visualisation] [tab] \"[RSS] Visualisation\" - efc6896326f55af7\n// [[RSS] Visualisation] [group] \"UI-Dashboard definitions\" - 813666329db1e709\n// [[RSS] Visualisation] [group] \"select a random link from all sources\" - 832e39cd06bd8aea\n// [[RSS] Visualisation] [group] \"rss sources\" - 5a899916a04657c2\n// [[RSS] Visualisation] [group] \"logic for handling various rss sources\" - 455a48126bb4679c\n// [[RSS] Visualisation] [group] \"what could possibly go wrong\" - 2844ae0db0d1d6b2\n// [[RSS] Visualisation] [group] \"\" - 876a8cd6d3a07422\n// [[RSS] Visualisation] [ui_template] \"Wikipedia recent changes\" - 242fe3dcd50b35fc\n// [[RSS] Visualisation] [ui_template] \"Random Link\" - 1c54cbfc7cacbf77\n// [[RSS] Visualisation] [catch] \"\" - 90ae62c4b25bc59c\n// [[RSS] Visualisation] [debug] \"debug 7\" - afd2d87d55438fca\n// [[RSS] Visualisation] [inject] \"Wikipedia recent changes\" - 932b6f50dba3503b\n// [[RSS] Visualisation] [subflow:73c1460c85149b2d] \"\" - 82b18ac1050aca64\n// [[RSS] Visualisation] [function] \"remove talk updates &amp; bot update\" - ad39353cb4e834d9\n// [[RSS] Visualisation] [batch] \"\" - 7e940bb26d4420d8\n// [[RSS] Visualisation] [template] \"\" - b21a161de05de174\n// [[RSS] Visualisation] [function] \"prepare payload\" - 7aab6fa31e830e7b\n// [[RSS] Visualisation] [function] \"prepare payload\" - df14573254422432\n// [[RSS] Visualisation] [join] \"\" - dc25943f9c4ff15d\n// [[RSS] Visualisation] [subflow:73c1460c85149b2d] \"\" - 9585d8464363dff6\n// [[RSS] Visualisation] [subflow:73c1460c85149b2d] \"\" - 92443dee182f60b9\n// [[RSS] Visualisation] [subflow:73c1460c85149b2d] \"\" - f64fe741cfe97192\n// [[RSS] Visualisation] [function] \"function 3\" - 9c653ce150aa8707\n// [[RSS] Visualisation] [inject] \"HN new comments\" - 0f72f97bed54f689\n// [[RSS] Visualisation] [template] \"\" - 667c16b9d864f391\n// [[RSS] Visualisation] [inject] \"HN newest\" - 3c73eca83fb0cc18\n// [[RSS] Visualisation] [template] \"\" - a2034e295df678e7\n// [[RSS] Visualisation] [inject] \"Wikipedia new pages\" - a4f71e535479c21b\n// [[RSS] Visualisation] [template] \"\" - 5a39571832a521f8\n// [[RSS] Visualisation] [template] \"\" - e4c120c7e332e478\n// [[RSS] Visualisation] [ui_template] \"Wikipedia new pages\" - 781c6d02fec073f6\n// [[RSS] Visualisation] [ui_template] \"HN new comments\" - 071d7bae4750b483\n// [[RSS] Visualisation] [ui_template] \"HN new pages\" - 168bd8528db5ce2b\n// [[RSS] Visualisation] [ui_template] \"RSS page title\" - 10485c22f940498a\n// [[RSS] Visualisation] [function] \"Remove &#39;New comment by&#39; string in title\" - d2a08631bed5dd2d\n// [[RSS] Visualisation] [ui_template] \"wiki recent \" - 447584a08272a04a\n// [[RSS] Visualisation] [ui_template] \"wiki new\" - 10b2f070b8fba1e3\n// [[RSS] Visualisation] [ui_template] \"HN new comments\" - 8755a344ce91004f\n// [[RSS] Visualisation] [ui_template] \"HN new pages title\" - 5f95d6adc7ea12a4\n// [[RSS] Visualisation] [subflow:73c1460c85149b2d] \"\" - d51ff5c1dae473dc\n// [[RSS] Visualisation] [inject] \"HN frontpage\" - d47baa4f4acb0601\n// [[RSS] Visualisation] [ui_template] \"HN frontpage\" - b07d8ee27476c204\n// [[RSS] Visualisation] [ui_template] \"HN frontpage\" - 2b7b7fea7401ad75\n// [[RSS] Visualisation] [switch] \"\" - 13556ad328ae3ec1\n// [[RSS] Visualisation] [function] \"prepare payload\" - 106c2c3bea41ab05\n// [[RSS] Visualisation] [FlowHubPush] \"\" - faec64116fc24dc9\n// [[RSS] Visualisation] [FlowHubPull] \"\" - 7338ded017e3a4b4\n// [[RSS] Visualisation] [function] \"only nodes from flow\" - 4c00777a470c6c52\n// [[RSS] Visualisation] [json] \"\" - a422bcdb8bb92639\n// [[RSS] Visualisation] [GetFlows] \"\" - d87f73dfd33438a4\n// [[RSS] Visualisation] [inject] \"\" - 710b5886018305d9\n// [[RSS] Visualisation] [debug] \"debug 22\" - efa53b7ab7378bb1\n// [[RSS] Visualisation] [template] \"\" - 8b747b1bb17f3bc3\n-->\n","env":[]},{"id":"813666329db1e709","type":"group","z":"efc6896326f55af7","name":"UI-Dashboard definitions","style":{"label":true},"nodes":["242fe3dcd50b35fc","1c54cbfc7cacbf77","781c6d02fec073f6","071d7bae4750b483","168bd8528db5ce2b","447584a08272a04a","10b2f070b8fba1e3","8755a344ce91004f","5f95d6adc7ea12a4","b07d8ee27476c204","2b7b7fea7401ad75"],"x":1667,"y":53,"w":272,"h":1125},{"id":"832e39cd06bd8aea","type":"group","z":"efc6896326f55af7","name":"select a random link from all sources","style":{"label":true},"nodes":["7e940bb26d4420d8","7aab6fa31e830e7b","df14573254422432","dc25943f9c4ff15d","9c653ce150aa8707","e4c120c7e332e478","106c2c3bea41ab05"],"x":878,"y":53,"w":729,"h":297},{"id":"5a899916a04657c2","type":"group","z":"efc6896326f55af7","name":"rss sources","style":{"label":true},"nodes":["932b6f50dba3503b","0f72f97bed54f689","3c73eca83fb0cc18","a4f71e535479c21b","d47baa4f4acb0601"],"x":60,"y":370,"w":312,"h":609},{"id":"455a48126bb4679c","type":"group","z":"efc6896326f55af7","name":"logic for handling various rss sources","style":{"label":true},"nodes":["82b18ac1050aca64","ad39353cb4e834d9","b21a161de05de174","9585d8464363dff6","92443dee182f60b9","f64fe741cfe97192","667c16b9d864f391","a2034e295df678e7","5a39571832a521f8","d2a08631bed5dd2d","d51ff5c1dae473dc","13556ad328ae3ec1"],"x":495.5,"y":497.5,"w":1020.5,"h":674.5},{"id":"2844ae0db0d1d6b2","type":"group","z":"efc6896326f55af7","name":"what could possibly go wrong","style":{"label":true},"nodes":["90ae62c4b25bc59c","afd2d87d55438fca"],"x":60,"y":1050,"w":312,"h":122},{"id":"242fe3dcd50b35fc","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"6a0cc5a16d5e33b2","name":"Wikipedia recent changes","order":3,"width":8,"height":11,"format":"<div class=\"markdown-body\" ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1803,"y":560,"wires":[[]]},{"id":"1c54cbfc7cacbf77","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"5c327a307cdc6e4e","name":"Random Link","order":6,"width":12,"height":3,"format":"<div class=\"markdown-body\" ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1763,"y":94,"wires":[[]]},{"id":"90ae62c4b25bc59c","type":"catch","z":"efc6896326f55af7","g":"2844ae0db0d1d6b2","name":"","scope":["82b18ac1050aca64","9585d8464363dff6","92443dee182f60b9","f64fe741cfe97192","d51ff5c1dae473dc"],"uncaught":false,"x":136,"y":1131,"wires":[["afd2d87d55438fca"]]},{"id":"afd2d87d55438fca","type":"debug","z":"efc6896326f55af7","g":"2844ae0db0d1d6b2","name":"debug 7","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":266,"y":1091,"wires":[]},{"id":"932b6f50dba3503b","type":"inject","z":"efc6896326f55af7","g":"5a899916a04657c2","name":"Wikipedia recent changes","props":[{"p":"feedUrl","v":"https://en.wikipedia.org/w/api.php?hidebots=1&hidecategorization=1&hideWikibase=1&urlversion=1&days=7&limit=50&action=feedrecentchanges&feedformat=atom","vt":"str"},{"p":"feedLimit","v":"30","vt":"num"},{"p":"requestTimeout","v":"4500","vt":"num"}],"repeat":"31","crontab":"","once":true,"onceDelay":0.1,"topic":"","x":226,"y":411,"wires":[["82b18ac1050aca64"]]},{"id":"82b18ac1050aca64","type":"subflow:73c1460c85149b2d","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"","x":631.5,"y":546,"wires":[[],["df14573254422432"],["ad39353cb4e834d9"]]},{"id":"ad39353cb4e834d9","type":"function","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"remove talk updates & bot update","func":"var newPayload = [];\n\nmsg.payload.forEach(function(element) {\n    if ( !element || !element.payload ) { return }\n    \n    if ( element.payload.title.match(/^User:/) ) {\n        return;\n    }\n    if (element.payload.title.match(/^User talk:/)) {\n        return;\n    }\n    if (element.payload.title.match(/^Talk:/)) {\n        return;\n    }\n    if (element.payload.author == \"AAlertBot\") {\n        return;\n    }\n    newPayload.push(element);\n});\n\nmsg.payload = newPayload;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1036,"y":560,"wires":[["b21a161de05de174"]]},{"id":"7e940bb26d4420d8","type":"batch","z":"efc6896326f55af7","g":"832e39cd06bd8aea","name":"","mode":"interval","count":10,"overlap":0,"interval":"10","allowEmptySequence":false,"topics":[],"x":1232,"y":244,"wires":[["dc25943f9c4ff15d"]]},{"id":"b21a161de05de174","type":"template","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"\n<ul>\n{{#payload}}\n<li>\n <a href=\"{{{ payload.link }}}\" target=\"_blank\">{{ payload.title }}</a>\n</li>\n{{/payload}}\n</ul>\n","output":"str","x":1340,"y":560,"wires":[["242fe3dcd50b35fc"]]},{"id":"7aab6fa31e830e7b","type":"function","z":"efc6896326f55af7","g":"832e39cd06bd8aea","name":"prepare payload","func":"// comment links take priority\nmsg.payload = [\n    msg.payload.title,\n    msg.payload.comment || msg.payload.comments || msg.payload.link\n];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":984,"y":243,"wires":[["7e940bb26d4420d8"]]},{"id":"df14573254422432","type":"function","z":"efc6896326f55af7","g":"832e39cd06bd8aea","name":"prepare payload","func":"\nmsg.payload = [\n        msg.payload.title,\n        msg.payload.link\n];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":984,"y":181,"wires":[["7e940bb26d4420d8"]]},{"id":"dc25943f9c4ff15d","type":"join","z":"efc6896326f55af7","g":"832e39cd06bd8aea","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"article.guid","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"10","count":"","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1335,"y":194,"wires":[["9c653ce150aa8707"]]},{"id":"9585d8464363dff6","type":"subflow:73c1460c85149b2d","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"","x":631.5,"y":783,"wires":[[],["7aab6fa31e830e7b"],["d2a08631bed5dd2d"]]},{"id":"92443dee182f60b9","type":"subflow:73c1460c85149b2d","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"","x":631.5,"y":933,"wires":[[],["106c2c3bea41ab05"],["a2034e295df678e7"]]},{"id":"f64fe741cfe97192","type":"subflow:73c1460c85149b2d","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"","x":631.5,"y":638,"wires":[[],["df14573254422432"],["5a39571832a521f8"]]},{"id":"9c653ce150aa8707","type":"function","z":"efc6896326f55af7","g":"832e39cd06bd8aea","name":"function 3","func":"if (msg.payload.length > 0 ) {\n    var tmp = msg.payload[ Math.floor(Math.random() * msg.payload.length )];\n\n    msg.payload = {\n        title: tmp[0],\n        link: tmp[1]\n    };\n    node.send(msg)\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1437,"y":148.5,"wires":[["e4c120c7e332e478"]]},{"id":"0f72f97bed54f689","type":"inject","z":"efc6896326f55af7","g":"5a899916a04657c2","name":"HN new comments","props":[{"p":"feedUrl","v":"https://hnrss.org/newcomments","vt":"str"},{"p":"feedLimit","v":"30","vt":"num"},{"p":"requestTimeout","v":"4500","vt":"num"}],"repeat":"61","crontab":"","once":true,"onceDelay":0.1,"topic":"","x":246,"y":649,"wires":[["9585d8464363dff6"]]},{"id":"667c16b9d864f391","type":"template","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"\n<ul>\n{{#payload}}\n<li>\n    <a href=\"{{{ payload.link }}}\" target=\"_blank\">{{ payload.title }}</a>\n</li>\n{{/payload}}\n</ul>\n","output":"str","x":1340,"y":798,"wires":[["071d7bae4750b483"]]},{"id":"3c73eca83fb0cc18","type":"inject","z":"efc6896326f55af7","g":"5a899916a04657c2","name":"HN newest","props":[{"p":"feedUrl","v":"https://hnrss.org/newest","vt":"str"},{"p":"feedLimit","v":"30","vt":"num"},{"p":"templateNr","v":"1","vt":"num"},{"p":"requestTimeout","v":"4500","vt":"num"}],"repeat":"113","crontab":"","once":true,"onceDelay":0.1,"topic":"","x":276,"y":799,"wires":[["92443dee182f60b9"]]},{"id":"a2034e295df678e7","type":"template","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<ul>\n{{#payload}}\n<li>\n    <a href=\"{{{ payload.link }}}\" target=\"_blank\">{{ payload.title }}</a> | <a href=\"{{{ payload.comments }}}\" target=\"_blank\">comments</a>\n</li>\n{{/payload}}\n</ul>\n","output":"str","x":1340,"y":947,"wires":[["13556ad328ae3ec1"]]},{"id":"a4f71e535479c21b","type":"inject","z":"efc6896326f55af7","g":"5a899916a04657c2","name":"Wikipedia new pages","props":[{"p":"feedUrl","v":"https://en.wikipedia.org/w/index.php?title=Special:NewPages&feed=atom","vt":"str"},{"p":"feedLimit","v":"20","vt":"num"},{"p":"requestTimeout","v":"4500","vt":"num"}],"repeat":"46","crontab":"","once":true,"onceDelay":0.1,"topic":"","x":236,"y":504,"wires":[["f64fe741cfe97192"]]},{"id":"5a39571832a521f8","type":"template","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"\n<ul>\n{{#payload}}\n<li>\n <a href=\"{{{ payload.link }}}\" target=\"_blank\">{{ payload.title }}</a>\n</li>\n{{/payload}}\n</ul>\n","output":"str","x":1340,"y":650,"wires":[["781c6d02fec073f6"]]},{"id":"e4c120c7e332e478","type":"template","z":"efc6896326f55af7","g":"832e39cd06bd8aea","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"{{#payload}}\n\n\n<h2>\n<a href=\"{{{ link }}}\" target=_blank>{{title}}</a>\n</h2>\n\n{{/payload}}\n","output":"str","x":1521,"y":94,"wires":[["1c54cbfc7cacbf77"]]},{"id":"781c6d02fec073f6","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"6a0cc5a16d5e33b2","name":"Wikipedia new pages","order":5,"width":8,"height":12,"format":"<div class=\"markdown-body\" ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1793,"y":650,"wires":[[]]},{"id":"071d7bae4750b483","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"6a0cc5a16d5e33b2","name":"HN new comments","order":11,"width":8,"height":10,"format":"\n\n<div class=\"markdown-body\" ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1783,"y":797,"wires":[[]]},{"id":"168bd8528db5ce2b","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"6a0cc5a16d5e33b2","name":"HN new pages","order":7,"width":8,"height":11,"format":"<div class=\"markdown-body\" ng-bind-html=\"msg.payload\"></div>\n","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1773,"y":1014,"wires":[[]]},{"id":"d2a08631bed5dd2d","type":"function","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"Remove 'New comment by' string in title","func":"msg.payload.forEach(function (element) {\n    if (!element || !element.payload) { return }\n\n    element.payload.title = element.payload.title.replace('New comment by ','');\n});\n\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1056,"y":797,"wires":[["667c16b9d864f391"]]},{"id":"447584a08272a04a","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"6a0cc5a16d5e33b2","name":"wiki recent ","order":2,"width":8,"height":1,"format":"<h4>Wikipedia recent changes</h4>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1763,"y":522,"wires":[[]]},{"id":"10b2f070b8fba1e3","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"6a0cc5a16d5e33b2","name":"wiki new","order":4,"width":8,"height":1,"format":"<h4>Wikipedia new pages</h4>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1753,"y":612,"wires":[[]]},{"id":"8755a344ce91004f","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"6a0cc5a16d5e33b2","name":"HN new comments","order":10,"width":8,"height":1,"format":"<h4>HackerNews new comments</h4>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1783,"y":755,"wires":[[]]},{"id":"5f95d6adc7ea12a4","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"6a0cc5a16d5e33b2","name":"HN new pages title","order":6,"width":8,"height":1,"format":"<h4>HackerNews new pages</h4>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1783,"y":976,"wires":[[]]},{"id":"d51ff5c1dae473dc","type":"subflow:73c1460c85149b2d","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"","x":631.5,"y":1085,"wires":[[],["106c2c3bea41ab05"],["a2034e295df678e7"]]},{"id":"d47baa4f4acb0601","type":"inject","z":"efc6896326f55af7","g":"5a899916a04657c2","name":"HN frontpage","props":[{"p":"feedUrl","v":"https://hnrss.org/frontpage","vt":"str"},{"p":"feedLimit","v":"30","vt":"num"},{"p":"templateNr","v":"2","vt":"num"},{"p":"requestTimeout","v":"4500","vt":"num"}],"repeat":"150","crontab":"","once":true,"onceDelay":0.1,"topic":"","x":266,"y":938,"wires":[["d51ff5c1dae473dc"]]},{"id":"b07d8ee27476c204","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"6a0cc5a16d5e33b2","name":"HN frontpage","order":9,"width":8,"height":11,"format":"<div class=\"markdown-body\" ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1773,"y":1137,"wires":[[]]},{"id":"2b7b7fea7401ad75","type":"ui_template","z":"efc6896326f55af7","g":"813666329db1e709","group":"6a0cc5a16d5e33b2","name":"HN frontpage","order":8,"width":8,"height":1,"format":"<h4>HackerNews Frontpage</h4>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1773,"y":1099,"wires":[[]]},{"id":"13556ad328ae3ec1","type":"switch","z":"efc6896326f55af7","g":"455a48126bb4679c","name":"","property":"templateNr","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"}],"checkall":"false","repair":false,"outputs":2,"x":1440,"y":1131,"wires":[["168bd8528db5ce2b"],["b07d8ee27476c204"]]},{"id":"106c2c3bea41ab05","type":"function","z":"efc6896326f55af7","g":"832e39cd06bd8aea","name":"prepare payload","func":"msg.payload = [\n    msg.payload.title,\n    msg.payload.link || msg.payload.comment || msg.payload.comments\n];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":984,"y":309,"wires":[["7e940bb26d4420d8"]]},{"id":"6a0cc5a16d5e33b2","type":"ui_group","name":"RSS","tab":"b9bfaf499a2237ae","order":1,"disp":false,"width":"8","collapse":false,"className":""},{"id":"5c327a307cdc6e4e","type":"ui_group","name":"Random Link","tab":"2d1524663469befc","order":1,"disp":true,"width":"12","collapse":false,"className":""},{"id":"b9bfaf499a2237ae","type":"ui_tab","name":"RSS","icon":"fa-rss","order":9,"disabled":false,"hidden":false},{"id":"2d1524663469befc","type":"ui_tab","name":"Random Link","icon":"dice","order":10,"disabled":false,"hidden":false}]